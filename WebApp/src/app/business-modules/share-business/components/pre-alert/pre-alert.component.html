<div class="pre-alert-page">
    <app-sub-header>
        <div class="c-button-actions">
            <app-default-button [buttonSetting]="cancelButtonSetting" (onClick)="cancelPreAlert()"></app-default-button>
        </div>
    </app-sub-header>
</div>
<div class="m-content">
    <div class="m-portlet">
        <div class="m-portlet__body">
            <form [formGroup]="formMail" class="m-form m-form--state">
                <div class="row">
                    <div class="col-md-1">
                        <div class="form-group">
                            <button *ngIf="(isLocked | async) === false"
                                class="btn btn-default  m-btn--icon m-btn--uppercase" (click)="sendMailSubmit()">
                                <i class="fa fa-envelope fa-2x" aria-hidden="true"></i>
                                <span style="margin-top: 5px;">{{sendMailButtonName}}</span>
                            </button>
                        </div>
                    </div>
                    <div class="col-md-11">
                        <div class="row">
                            <div class="col-md-1">
                                <div class="form-group">
                                    <button style="width:54px;" type="label"
                                        class="btn btn-default  m-btn--icon m-btn--uppercase ">
                                        from...
                                    </button>
                                </div>
                            </div>
                            <div class="col-md-11">
                                <div class="form-group">
                                    <input class="form-control" disabled="true" formControlName="from"
                                        oninput="this.value=this.value.replace(/(<|>|'|,)/g,'')" />
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-1">
                                <div class="form-group">
                                    <button style="width:54px;" class="btn btn-default  m-btn--icon m-btn--uppercase ">
                                        to...
                                    </button>
                                </div>
                            </div>
                            <div class="col-md-11">
                                <div class="form-group"
                                    [ngClass]="{'m-form__group has-danger': (to.dirty && !to.valid) || (isSubmited && !to.valid)}">
                                    <input class="form-control" formControlName="to"
                                        oninput="this.value=this.value.replace(/(<|>|'|,)/g,'')" />
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-1">
                                <div class="form-group">
                                    <button style="width:54px;" class="btn btn-default  m-btn--icon m-btn--uppercase ">
                                        cc...
                                    </button>
                                </div>
                            </div>
                            <div class="col-md-11">
                                <div class="form-group"
                                    [ngClass]="{'m-form__group has-danger': (cc.dirty && !cc.valid) || (isSubmited && !cc.valid)}">
                                    <input class="form-control" formControlName="cc" />
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-1">
                                <div class="form-group">
                                    <button style="width:54px;" class="btn  m-btn--icon m-btn--uppercase">
                                        subject:
                                    </button>
                                </div>
                            </div>
                            <div class="col-md-11">
                                <div class="form-group"
                                    [ngClass]="{'m-form__group has-danger': (subject.dirty && !subject.valid) || (isSubmited && !subject.valid)}">
                                    <input class="form-control" formControlName="subject" />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <div class="form-group">
                            <div [froalaEditor]="optionEditor" formControlName="body"></div>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
    <div class="row">
        <div class="col-lg-6"></div>
        <div class="col-lg-6 m--align-right">
            <div class="">
                <button *ngIf="(isLocked | async) === false" style="float:right"
                    class="btn btn-success  m-btn--icon m-btn--uppercase" (click)="showPopup()">
                    <span>
                        <i class="la la-plus"></i>
                        <span>
                            Add Attachment...
                        </span>
                    </span></button>
            </div>
        </div>
    </div>
    <div class="m-portlet m--margin-top-10">
        <div class="alert-block__heading">
            <div class="d-flex justify-content-between align-items-center">
                <h3 class="alert-block__title">
                    Attached File
                </h3>
            </div>
        </div>
        <div class="m-portlet__body">
            <div class="row">
                <div class="col-lg-12">
                    <div class="form-group m-form__group"
                        *ngIf="isArrivalNotice && (serviceId === 'AI' || serviceId === 'SFI' || serviceId === 'SLI' || serviceId === 'SCI')">
                        <div class="m-checkbox-inline">
                            <ng-container *ngIf="isExitsArrivalNotice else NotArrivalNotice">
                                <label class="m-checkbox m-checkbox--bold" style="display: initial;">
                                    <input type="checkbox" [(ngModel)]="isCheckedArrivalNotice"
                                        (change)="onChangeCheckBox()">
                                    <span></span>
                                </label>
                                <span>
                                    <a class="pointer" (click)="previewArrivalNotice()">Arrival Notice</a>
                                </span>
                            </ng-container>
                            <ng-template #NotArrivalNotice>
                                <label class="m-checkbox m-checkbox--bold m-checkbox--disabled"
                                    style="display: initial; margin-right: 40px;">
                                    <input type="checkbox" disabled="true">
                                    Arrival Notice
                                    <span></span>
                                </label>
                            </ng-template>

                            <ng-container *ngIf="isExitsDebitNote else NotDebitNote">
                                <ng-container *ngFor="let debitNo of debitNos">
                                    <label class="m-checkbox m-checkbox--bold"
                                        style="display: initial;margin-left: 20px">
                                        <input type="checkbox" [(ngModel)]="debitNo.isCheckedDebitNote"
                                            (change)="onChangeCheckBox()">
                                        <span></span>
                                    </label>
                                    <span>
                                        <a class="pointer" (click)="previewDebitNote(debitNo.code)">{{debitNo.code}}</a>
                                    </span>
                                </ng-container>
                            </ng-container>
                            <ng-template #NotDebitNote>
                                <label class="m-checkbox m-checkbox--bold m-checkbox--disabled"
                                    style="display: initial; margin-right: 40px;">
                                    <input type="checkbox" disabled="true">
                                    Debit Note
                                    <span></span>
                                </label>
                            </ng-template>

                            <ng-container *ngIf="isExitsDO else NotDO">
                                <label class="m-checkbox m-checkbox--bold" style="display: initial;margin-left: 20px;">
                                    <input type="checkbox" [(ngModel)]="isCheckedDO" (change)="onChangeCheckBox()">
                                    <span></span>
                                </label>
                                <span>
                                    <a class="pointer" (click)="previewDO()">Delivery Order</a>
                                </span>
                            </ng-container>
                            <ng-template #NotDO>
                                <label class="m-checkbox m-checkbox--bold m-checkbox--disabled"
                                    style="display: initial; margin-right: 40px;">
                                    <input type="checkbox" disabled="true">
                                    Delivery Order
                                    <span></span>
                                </label>
                            </ng-template>
                        </div>
                    </div>
                    <div class="form-group m-form__group"
                        *ngIf="isPreAlert && (serviceId === 'AE' || serviceId === 'SFE' || serviceId === 'SLE')">
                        <div class="m-checkbox-inline">
                            <ng-container *ngIf="isExitsManifest else NotManifest">
                                <label class="m-checkbox m-checkbox--bold" style="display: initial;">
                                    <input type="checkbox" [(ngModel)]="isCheckedManifest"
                                        (change)="onChangeCheckBox()">
                                    <span></span>
                                </label>
                                <span style="margin-right: 40px;"><a class="pointer"
                                        (click)="previewManifest()">Manifest</a></span>
                            </ng-container>
                            <ng-template #NotManifest>
                                <label class="m-checkbox m-checkbox--bold m-checkbox--disabled"
                                    style="display: initial; margin-right: 40px;">
                                    <input type="checkbox" disabled="true">
                                    Manifest
                                    <span></span>
                                </label>
                            </ng-template>

                            <ng-container *ngIf="isExitsHawb else NotHawb">
                                <ng-container *ngFor="let hbl of hawbDetails">
                                    <label class="m-checkbox m-checkbox--bold"
                                        style="display: initial;margin-left: 20px;">
                                        <input type="checkbox" [(ngModel)]="hbl.isCheckedHawb"
                                            (change)="onChangeCheckBox()">
                                        <span></span>
                                    </label>
                                    <span>
                                        <a class="pointer" (click)="previewHawb(hbl.id)">{{hbl.hwbno}}</a>
                                    </span>
                                </ng-container>
                                <!-- {{hblRptName}} -->
                            </ng-container>
                            <ng-template #NotHawb>
                                <label class="m-checkbox m-checkbox--bold m-checkbox--disabled"
                                    style="display: initial; margin-right: 40px;">
                                    <input type="checkbox" disabled="true">
                                    HAWB
                                    <span></span>
                                </label>
                            </ng-template>

                            <ng-container *ngIf="isExitsDebitNote else NotDebitNote">
                                <ng-container *ngFor="let debitNo of debitNos">
                                    <label class="m-checkbox m-checkbox--bold"
                                        style="display: initial;margin-left: 20px">
                                        <input type="checkbox" [(ngModel)]="debitNo.isCheckedDebitNote"
                                            (change)="onChangeCheckBox()">
                                        <span></span>
                                    </label>
                                    <span>
                                        <a class="pointer"
                                            (click)="previewCDNoteExport(debitNo.code)">{{debitNo.code}}</a>
                                    </span>
                                </ng-container>
                            </ng-container>
                            <ng-template #NotDebitNote>
                                <label class="m-checkbox m-checkbox--bold m-checkbox--disabled"
                                    style="display: initial; margin-right: 40px;">
                                    <input type="checkbox" disabled="true">
                                    CD Note
                                    <span></span>
                                </label>
                            </ng-template>
                        </div>
                    </div>

                    <div class="form-group m-form__group"
                        *ngIf="isSI && (serviceId === 'SFE' || serviceId === 'SLE')">
                        <div class="m-checkbox-inline">
                            <ng-container *ngIf="isExitsSISummary else NotSISummary">
                                <label class="m-checkbox m-checkbox--bold" style="display: initial;">
                                    <input type="checkbox" [(ngModel)]="isCheckedSISummary"
                                        (change)="onChangeCheckBox()">
                                    <span></span>
                                </label>
                                <span style='margin-right: 20px;'>
                                    <a class="pointer" (click)="previewSISummary()">SI Summary</a>
                                </span>
                            </ng-container>
                            <ng-template #NotSISummary>
                                <label class="m-checkbox m-checkbox--bold m-checkbox--disabled"
                                    style="display: initial; margin-right: 40px;">
                                    <input type="checkbox" disabled="true">
                                    SI Summary
                                    <span></span>
                                </label>
                            </ng-template>

                            <ng-container *ngIf="isExitsSI else NotSI">
                                <label class="m-checkbox m-checkbox--bold" style="display: initial;margin-left: 20px;">
                                    <input type="checkbox" [(ngModel)]="isCheckedSI" (change)="onChangeCheckBox()">
                                    <span></span>
                                </label>
                                <span>
                                    <a class="pointer" (click)="previewSI()">SI HBL Detail</a>
                                </span>
                            </ng-container>
                            <ng-template #NotSI>
                                <label class="m-checkbox m-checkbox--bold m-checkbox--disabled"
                                    style="display: initial; margin-right: 40px;">
                                    <input type="checkbox" disabled="true">
                                    SI HBL Detail
                                    <span></span>
                                </label>
                            </ng-template>

                            <ng-container *ngIf="isExitsSIDetailCont else NotSIDetailCont">
                                <label class="m-checkbox m-checkbox--bold" style="display: initial;margin-left: 20px;">
                                    <input type="checkbox" [(ngModel)]="isCheckedSIDetailCont"
                                        (change)="onChangeCheckBox()">
                                    <span></span>
                                </label>
                                <span>
                                    <a class="pointer" (click)="previewSIDetailCont(serviceId)">SI Detail (Cont)</a>
                                </span>
                            </ng-container>
                            <ng-template #NotSIDetailCont>
                                <label class="m-checkbox m-checkbox--bold m-checkbox--disabled"
                                    style="display: initial; margin-right: 40px;">
                                    <input type="checkbox" disabled="true">
                                    SI Detail (Cont)
                                    <span></span>
                                </label>
                            </ng-template>
                        </div>
                    </div>
                    <!-- Send D.O / A.L-->
                    <div class="form-group m-form__group"
                        *ngIf="(isDO && (serviceId === 'SFI' || serviceId === 'SLI' || serviceId === 'SCI')) || (isAL && serviceId === 'AI')">
                        <div class="m-checkbox-inline">
                            <ng-container>
                                <label class="m-checkbox m-checkbox--bold" style="display: initial;">
                                    <input type="checkbox" [(ngModel)]="isCheckedDO"
                                        (change)="onChangeCheckBox()">
                                    <span></span>
                                </label>
                                <span style='margin-right: 20px;' *ngIf="isDO">
                                    <a class="pointer" (click)="previewDO()">Delivery Order</a>
                                </span>
                                <span style='margin-right: 20px;' *ngIf="isAL">
                                    <a class="pointer" (click)="previewDO()">Authorize Letter</a>
                                </span>
                            </ng-container>
                            <!-- <ng-template #NotDO>
                                <label class="m-checkbox m-checkbox--bold m-checkbox--disabled"
                                    style="display: initial; margin-right: 40px;">
                                    <input type="checkbox" disabled="true">
                                    Delivery Order
                                    <span></span>
                                </label>
                            </ng-template> -->
                        </div>
                    </div>

                    <!-- Send POD -->
                    <div class="form-group m-form__group"
                        *ngIf="isPOD && (serviceId === 'SFI' || serviceId === 'SLI' || serviceId === 'AI')">
                        <div class="m-checkbox-inline">
                            <ng-container>
                                <label class="m-checkbox m-checkbox--bold" style="display: initial;">
                                    <input type="checkbox" [(ngModel)]="isCheckedPOD"
                                        (change)="onChangeCheckBox()">
                                    <span></span>
                                </label>
                                <span style='margin-right: 20px;'>
                                    <a class="pointer" (click)="previewProofofDelivery()">Proof Of Delivery</a>
                                </span>
                            </ng-container>
                        </div>
                    </div>

                    <!-- Send HBL -->
                    <div class="form-group m-form__group"
                        *ngIf="isSendHbl && (serviceId === 'SFE' || serviceId === 'SLE' || serviceId === 'AE')">
                        <div class="m-checkbox-inline">
                            <ng-container>
                                <label class="m-checkbox m-checkbox--bold" style="display: initial;">
                                    <input type="checkbox" [(ngModel)]="hawbDetails[0].isCheckedHawb"
                                        (change)="onChangeCheckBox()">
                                    <span></span>
                                </label>
                                <span style='margin-right: 20px;'>
                                    <a class="pointer" (click)="previewHawb(hawbDetails[0].id)">{{hawbDetails[0].hwbno}}</a>
                                </span>
                            </ng-container>
                        </div>
                    </div>

                </div>
                <div class="col-lg-12" *ngFor="let file of files; trackBy:trackByFn">
                    <div class="form-group m-form__group">
                        <div class="d-flex align-items-center justify-content-between">
                            <div class="d-flex align-items-center">
                                <div class="file-item__icon">
                                    <ng-container [ngSwitch]="file.extension">
                                        <ng-container *ngSwitchCase="'pdf'">
                                            <i class="fa fa-file-pdf-o fa-2x" aria-hidden="true"></i>
                                        </ng-container>
                                        <ng-container *ngSwitchCase="'doc'">
                                            <i class="fa fa-file-word-o fa-2x" aria-hidden="true"></i>
                                        </ng-container>
                                        <ng-container *ngSwitchCase="'docx'">
                                            <i class="fa fa-file-word-o fa-2x" aria-hidden="true"></i>
                                        </ng-container>
                                        <ng-container *ngSwitchCase="'xlsx'">
                                            <i class="fa fa-file-excel-o fa-2x" aria-hidden="true"></i>
                                        </ng-container>
                                        <ng-container *ngSwitchCase="'xls'">
                                            <i class="fa fa-file-excel-o fa-2x" aria-hidden="true"></i>
                                        </ng-container>
                                        <ng-container *ngSwitchCase="'txt'">
                                            <i class="fa fa-file-text-o fa-2x" aria-hidden="true"></i>
                                        </ng-container>
                                        <ng-container *ngSwitchCase="'jpg'">
                                            <i class="fa fa-file-image-o fa-2x" aria-hidden="true"></i>
                                        </ng-container>
                                        <ng-container *ngSwitchCase="'png'">
                                            <i class="fa fa-file-image-o fa-2x" aria-hidden="true"></i>
                                        </ng-container>
                                        <ng-container *ngSwitchDefault>
                                            <i class="fa fa-file fa-2x" aria-hidden="true"></i>
                                        </ng-container>
                                    </ng-container>
                                </div>
                                <div class="file-item__name m--margin-left-20">
                                    <a [href]="file.url" target="_blank" [title]="file.name" download>{{file.name}}</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>

<add-attachment-popup (onAdd)="onAddFile($event)"></add-attachment-popup>

<form class="hidden" #formReportPDF target="framePDF" method="POST" [action]="srcReportPDF | safe:'resourceUrl'">
    <input name="crystal" type="hidden" [value]="valuePDF">
</form>
<iframe style="display: none;" #framePDF id="framePDF" name="framePDF" src="" type="application/pdf" height="1080px"
    width="100%" allowfullscreen frameborder="0"></iframe>

<!-- <ng-container *ngIf="dataReport">
    <app-report-preview [data]="dataReport"></app-report-preview>
</ng-container> -->

<ng-template inject></ng-template>