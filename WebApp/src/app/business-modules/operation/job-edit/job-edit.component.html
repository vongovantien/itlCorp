<!--begin:: subheader-->
<div class="m-subheader">
    <div class="d-flex align-items-center">
        <div class="mr-auto">
            <app-breadcrumb></app-breadcrumb>
        </div>
        <div class="c-button-actions">
            <button type="button" class="btn btn-danger m-btn--square m-btn--icon m-btn--uppercase"
                (click)="confirmDelete()">
                <span>
                    <i class="la la-trash"></i>
                    <span>
                        delete
                    </span>
                </span>
            </button>
        </div>
        <button type="button" class="btn m-btn--square m-btn--icon m-btn--uppercase" data-toggle="modal"
            data-target="#confirm-cancel-job-modal">
            <span>
                <i class="la la-ban"></i>
                <span>
                    cancel
                </span>
            </span>
        </button>
    </div>
</div>
<!--end:: subheader-->

<!--begin:: m-content -->
<div class="m-content" *ngIf="opsTransaction">
    <div class="row">
        <div class="col-12">
            <tabset type="tabs">
                <tab heading="Job detail" (selectTab)="selectTab($event,'job-edit')">
                    <div *ngIf="tab === 'job-edit'">
                        <!--begin::Form-->
                        <form novalidate #addOpsForm="ngForm" name="addOpsForm" (ngSubmit)="addOpsForm.form.valid">

                            <div class="m-form m-form--state">
                                <!--begin::m-portlet -->
                                <div class="m-portlet">
                                    <div class="alert-block__heading">
                                        <h3 class="alert-block__title">Job Information</h3>
                                    </div>
                                    <div class="m-portlet__body" id="edit-ops-job-form" *ngIf="isDisplay">
                                        <!--begin:: form-actions-->
                                        <div class="form-actions m--align-right">
                                            <button type=""
                                                class="btn btn-brand m-btn--square m-btn--icon m-btn--uppercase"
                                                (click)="saveShipment(addOpsForm)">
                                                <span>
                                                    <i class="la la la-save"></i>
                                                    <span>
                                                        save detail
                                                    </span>
                                                </span>
                                            </button>
                                            <button type="button"
                                                class="btn btn-cancel m-btn--square m-btn--icon m-btn--uppercase"
                                                data-toggle="modal" data-target="#cancel-create-ops-job-modal">
                                                <span>
                                                    <i class="la la-ban"></i>
                                                    <span>
                                                        cancel
                                                    </span>
                                                </span>
                                            </button>
                                        </div>
                                        <!--end:: form-actions-->
                                        <!--begin:: General Information -->
                                        <div class="div-inside bg-secondary m--margin-bottom-15">
                                            <h3 class="c-block-title">General Information</h3>
                                            <hr>
                                            <div class="row">
                                                <div class="col-lg-4">
                                                    <div class="form-group">
                                                        <label class="form-control-label" for="">
                                                            Job ID
                                                            <!-- <span class="m--font-danger">(*)</span> -->
                                                        </label>
                                                        <input type="text" required
                                                            class="form-control m-input m-input--square"
                                                            placeholder="Enter text" name="jobNo" disabled=true
                                                            [(ngModel)]="opsTransaction.jobNo" #jobNo="ngModel">
                                                        <!-- <div class="form-control-feedback" style="display: none">
                                                    HBL No is required!
                                                </div> -->
                                                    </div>
                                                </div>
                                                <!-- <div class="col-lg-4">
                                            <div class="form-group">
                                                <label class="form-control-label" for="">
                                                    MBL No
                                                </label>
                                                <input type="text" required class="form-control m-input m-input--square"
                                                    placeholder="Enter text" name="">
                                            </div>
                                        </div> -->
                                                <div class="col-lg-4">
                                                    <div class="form-group"
                                                        [ngClass]="{ 'has-danger': addOpsForm.submitted && serviceDate == null }">
                                                        <label class="form-control-label" for="">
                                                            Service Date <span class="m--font-danger">(*)</span>
                                                        </label>
                                                        <div class="m-input-icon m-input-icon--right down">
                                                            <input type="text"
                                                                class="form-control m-input m-input--square"
                                                                ngxDaterangepickerMd [autoApply]="true"
                                                                [locale]="{applyLabel: 'ok', format: 'DD/MM/YYYY'}"
                                                                [(ngModel)]="serviceDate" [singleDatePicker]="true"
                                                                name="serviceDate" readonly />
                                                            <span class="m-input-icon__icon m-input-icon__icon--right">
                                                                <span>
                                                                    <i class="la la-calendar"></i>
                                                                </span>
                                                            </span>
                                                        </div>
                                                        <div class="form-control-feedback"
                                                            *ngIf="addOpsForm.submitted && serviceDate == null">
                                                            Service Date is required!
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-lg-4">
                                                    <div class="form-group"
                                                        [ngClass]="{ 'has-danger': addOpsForm.submitted && finishDate != null && this.finishDate.startDate != null && this.serviceDate.startDate != null && (this.finishDate.startDate < this.serviceDate.startDate)}">
                                                        <label class="form-control-label" for="">
                                                            Finish Date
                                                        </label>
                                                        <div class="m-input-icon m-input-icon--right down">
                                                            <input type="text"
                                                                class="form-control m-input m-input--square"
                                                                ngxDaterangepickerMd [autoApply]="true"
                                                                [locale]="{applyLabel: 'ok', format: 'DD/MM/YYYY'}"
                                                                [(ngModel)]="finishDate" [singleDatePicker]="true"
                                                                name="finishDate" readonly />
                                                            <span class="m-input-icon__icon m-input-icon__icon--right">
                                                                <span>
                                                                    <i class="la la-calendar"></i>
                                                                </span>
                                                            </span>
                                                        </div>
                                                        <div class="form-control-feedback"
                                                            *ngIf="addOpsForm.submitted && this.finishDate.startDate != null && this.serviceDate.startDate != null && (this.finishDate.startDate < this.serviceDate.startDate)">
                                                            Finish Date must more greater or equal Service Date
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-lg-4">
                                                    <div class="form-group"
                                                        [ngClass]="{'m-form__group has-danger':addOpsForm.submitted && opsTransaction.productService == null}">
                                                        <label class="form-control-label" for="">
                                                            Product Service <span class="m--font-danger">(*)</span>
                                                        </label>
                                                        <ng-select [allowClear]="true" [items]="productServices"
                                                            (data)="refreshValue($event)"
                                                            [active]="productServiceActive"
                                                            (selected)="opsTransaction.productService = $event.id"
                                                            (removed)="opsTransaction.productService = null"
                                                            (typed)="typed($event)" placeholder="Please Select">
                                                        </ng-select>
                                                        <div class="form-control-feedback"
                                                            *ngIf="addOpsForm.submitted && opsTransaction.productService === null">
                                                            Product Service is required!
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-lg-4">
                                                    <div class="form-group"
                                                        [ngClass]="{'m-form__group has-danger':addOpsForm.submitted && opsTransaction.serviceMode == null}">
                                                        <label class="form-control-label" for="">
                                                            Service Mode <span class="m--font-danger">(*)</span>
                                                        </label>
                                                        <ng-select [allowClear]="true" [items]="serviceModes"
                                                            (data)="refreshValue($event)" [active]="serviceModeActive"
                                                            (selected)="opsTransaction.serviceMode = $event.id"
                                                            (removed)="opsTransaction.serviceMode = null"
                                                            (typed)="typed($event)" placeholder="Please Select">
                                                        </ng-select>
                                                        <div class="form-control-feedback"
                                                            *ngIf="addOpsForm.submitted && opsTransaction.serviceMode === null">
                                                            Service Mode is required!
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-lg-4">
                                                    <div class="form-group"
                                                        [ngClass]="{'m-form__group has-danger':addOpsForm.submitted && opsTransaction.shipmentMode == null}">
                                                        <label class="form-control-label" for="">
                                                            Shipment Mode <span class="m--font-danger">(*)</span>
                                                        </label>
                                                        <ng-select [allowClear]="true" [items]="shipmentModes"
                                                            (data)="refreshValue($event)" [active]="shipmentModeActive"
                                                            (selected)="opsTransaction.shipmentMode = $event.id"
                                                            (removed)="opsTransaction.shipmentMode = null"
                                                            (typed)="typed($event)" placeholder="Please Select">
                                                        </ng-select>
                                                        <div class="form-control-feedback"
                                                            *ngIf="addOpsForm.submitted && opsTransaction.shipmentMode === null">
                                                            Shipment Mode is required!
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-lg-4">
                                                    <div class="form-group"
                                                        [ngClass]="{'m-form__group has-danger':addOpsForm.submitted && hwbno.invalid}">
                                                        <label class="form-control-label" for="">
                                                            HBL No <span class="m--font-danger">(*)</span>
                                                        </label>
                                                        <input type="text" required
                                                            class="form-control m-input m-input--square"
                                                            placeholder="Enter text" name="hwbno"
                                                            [(ngModel)]="opsTransaction.hwbno" #hwbno="ngModel">
                                                        <div class="form-control-feedback"
                                                            *ngIf="addOpsForm.submitted && hwbno.invalid">
                                                            HBL No is required!
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-lg-4">
                                                    <div class="form-group"
                                                        [ngClass]="{'m-form__group has-danger':addOpsForm.submitted && mblno.invalid}">
                                                        <label class="form-control-label" for="">
                                                            MBL No <span class="m--font-danger">(*)</span>
                                                        </label>
                                                        <input type="text" required
                                                            class="form-control m-input m-input--square"
                                                            placeholder="Enter text" name="mblno"
                                                            [(ngModel)]="opsTransaction.mblno" #mblno="ngModel">
                                                        <div class="form-control-feedback"
                                                            *ngIf="addOpsForm.submitted && mblno.invalid">
                                                            MBL No is required!
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-lg-4">
                                                    <div class="form-group">
                                                        <label class="form-control-label" for=""
                                                            [ngClass]="{'m-form__group has-danger':addOpsForm.submitted && opsTransaction.customerId == null}">
                                                            Customer <span class="m--font-danger">(*)</span>
                                                        </label>
                                                        <app-combo-grid-virtual-scroll
                                                            [currentActiveItemId]="{field:'id',value:opsTransaction.customerId}"
                                                            (itemSelected)="opsTransaction.customerId = $event.id"
                                                            [selectedDisplayFields]="['partnerNameEn']"
                                                            [dataSources]="customers"
                                                            [displayFields]="[{'field':'id','label':'Partner ID'},{'field':'shortName','label':'Name ABBR'},{'field':'partnerNameEn','label':'Name EN'},{'field':'taxCode','label':'Tax Code'}]">
                                                        </app-combo-grid-virtual-scroll>
                                                        <div class="form-control-feedback"
                                                            *ngIf="addOpsForm.submitted && opsTransaction.customerId == null">
                                                            Customer is required!
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">

                                                <div class="col-lg-4">
                                                    <div class="form-group"
                                                        [ngClass]="{'m-form__group has-danger': addOpsForm.submitted && (opsTransaction.pol === opsTransaction.pod) && (opsTransaction.pol!==null)}">
                                                        <label class="form-control-label" for="">
                                                            Port of Loading
                                                        </label>
                                                        <app-combo-grid-virtual-scroll
                                                            [currentActiveItemId]="{field:'id',value:opsTransaction.pol}"
                                                            (itemSelected)="opsTransaction.pol=$event.id"
                                                            [selectedDisplayFields]="['nameEn']" [dataSources]="ports"
                                                            [displayFields]="[{'field':'code','label':'Port Code'},{'field':'nameEn','label':'Port Name'},{'field':'countryNameEN','label':'Country'}]">
                                                        </app-combo-grid-virtual-scroll>
                                                        <div class="form-control-feedback"
                                                            *ngIf="addOpsForm.submitted && (opsTransaction.pol === opsTransaction.pod) && (opsTransaction.pol!==null)">
                                                            Port of loading is must be different with port of discharge
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-lg-4">
                                                    <div class="form-group"
                                                        [ngClass]="{'m-form__group has-danger': addOpsForm.submitted && (opsTransaction.pol === opsTransaction.pod) && (opsTransaction.pol!==null)}">
                                                        <label class="form-control-label" for="">
                                                            Port of Discharge
                                                        </label>
                                                        <app-combo-grid-virtual-scroll
                                                            [currentActiveItemId]="{field:'id',value:opsTransaction.pod}"
                                                            (itemSelected)="opsTransaction.pod = $event.id"
                                                            [selectedDisplayFields]="['nameEn']" [dataSources]="ports"
                                                            [displayFields]="[{'field':'code','label':'Port Code'},{'field':'nameEn','label':'Port Name'},{'field':'countryNameEN','label':'Country'}]">
                                                        </app-combo-grid-virtual-scroll>
                                                        <div class="form-control-feedback"
                                                            *ngIf="addOpsForm.submitted && (opsTransaction.pol === opsTransaction.pod) && (opsTransaction.pol!==null)">
                                                            Port of discharge must be different with port of loading
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-lg-4">
                                                    <div class="form-group">
                                                        <label class="form-control-label" for="">
                                                            Supplier
                                                        </label>
                                                        <app-combo-grid-virtual-scroll
                                                            [currentActiveItemId]="{field:'id',value:opsTransaction.supplierId}"
                                                            (itemSelected)="opsTransaction.supplierId = $event.id"
                                                            [selectedDisplayFields]="['partnerNameEn']"
                                                            [dataSources]="suppliers"
                                                            [displayFields]="[{'field':'id','label':'Partner ID'},{'field':'shortName','label':'Name ABBR'},{'field':'partnerNameEn','label':'Name EN'},{'field':'taxCode','label':'Tax Code'}]">
                                                        </app-combo-grid-virtual-scroll>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-lg-4">
                                                    <div class="form-group">
                                                        <label class="form-control-label" for="">
                                                            Vessel/Flight
                                                        </label>
                                                        <input type="text" class="form-control m-input m-input--square"
                                                            placeholder="Enter text" name="flightVessel"
                                                            [(ngModel)]="opsTransaction.flightVessel"
                                                            #flightVessel="ngModel">
                                                        <!-- <div class="form-control-feedback"
                                                *ngIf="addOpsForm.submitted && flightVessel.invalid">
                                                Vessel/Flight No is required!
                                            </div> -->
                                                    </div>
                                                </div>
                                                <div class="col-lg-4">
                                                    <div class="form-group">
                                                        <label class="form-control-label" for="">
                                                            Agent
                                                        </label>
                                                        <app-combo-grid-virtual-scroll
                                                            [currentActiveItemId]="{field:'id',value:opsTransaction.agentId}"
                                                            (itemSelected)="opsTransaction.agentId = $event.id"
                                                            [selectedDisplayFields]="['partnerNameEn']"
                                                            [dataSources]="agents"
                                                            [displayFields]="[{'field':'id','label':'Partner ID'},{'field':'shortName','label':'Name ABBR'},{'field':'partnerNameEn','label':'Name EN'},{'field':'taxCode','label':'Tax Code'}]">
                                                        </app-combo-grid-virtual-scroll>
                                                    </div>
                                                </div>
                                                <div class="col-lg-4">
                                                    <div class="form-group">
                                                        <label class="form-control-label" for="">
                                                            Warehouse
                                                        </label>
                                                        <app-combo-grid-virtual-scroll
                                                            [currentActiveItemId]="{field:'id',value:opsTransaction.warehouseId}"
                                                            (itemSelected)="opsTransaction.warehouseId = $event.id"
                                                            [selectedDisplayFields]="['nameEn']" [dataSources]="ports"
                                                            [displayFields]="[{'field':'code','label':'Port Code'},{'field':'nameEn','label':'Port Name'},{'field':'countryNameEN','label':'Country'}]">
                                                        </app-combo-grid-virtual-scroll>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-lg-4">
                                                    <div class="form-group">
                                                        <label class="form-control-label" for="">
                                                            Invoice No
                                                        </label>
                                                        <input type="text" class="form-control m-input m-input--square"
                                                            name="invoiceNo" placeholder="Enter text"
                                                            [(ngModel)]="opsTransaction.invoiceNo" #invoiceNo="ngModel">
                                                    </div>
                                                </div>
                                                <div class="col-lg-4">
                                                    <div class="form-group">
                                                        <label class="form-control-label" for="">
                                                            Purchase Order No
                                                        </label>
                                                        <input type="text" class="form-control m-input m-input--square"
                                                            placeholder="Enter text" name="purchaseOrderNo"
                                                            [(ngModel)]="opsTransaction.purchaseOrderNo"
                                                            #purchaseOrderNo="ngModel">
                                                    </div>
                                                </div>
                                                <div class="col-lg-4">
                                                    <div class="form-group">
                                                        <label class="form-control-label" for="">
                                                            Saleman
                                                        </label>
                                                        <app-combo-grid-virtual-scroll
                                                            [currentActiveItemId]="{field:'id',value:opsTransaction.salemanId}"
                                                            (itemSelected)="opsTransaction.salemanId = $event.id"
                                                            [selectedDisplayFields]="['employeeNameEn']"
                                                            [dataSources]="salemans"
                                                            [displayFields]="[{'field':'username','label':'User Name'},{'field':'employeeNameEn','label':'Full Name'},{'field':'','label':'Role'}]">
                                                        </app-combo-grid-virtual-scroll>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-lg-4">
                                                    <div class="form-group">
                                                        <label class="form-control-label" for="">
                                                            Field OPS
                                                        </label>
                                                        <app-combo-grid-virtual-scroll
                                                            [currentActiveItemId]="{field:'id',value:opsTransaction.fieldOpsId}"
                                                            (itemSelected)="opsTransaction.fieldOpsId = $event.id"
                                                            [selectedDisplayFields]="['employeeNameEn']"
                                                            [dataSources]="billingOps"
                                                            [displayFields]="[{'field':'username','label':'User Name'},{'field':'employeeNameEn','label':'Full Name'},{'field':'','label':'Role'}]">
                                                        </app-combo-grid-virtual-scroll>
                                                    </div>
                                                </div>
                                                <div class="col-lg-4">
                                                    <div class="form-group"
                                                        [ngClass]="{'m-form__group has-danger':addOpsForm.submitted && opsTransaction.billingOpsId == null}">
                                                        <label class="form-control-label" for="">
                                                            Billing OPS <span class="m--font-danger">(*)</span>
                                                        </label>
                                                        <app-combo-grid-virtual-scroll
                                                            [currentActiveItemId]="{field:'id',value:opsTransaction.billingOpsId}"
                                                            (itemSelected)="opsTransaction.billingOpsId = $event.id"
                                                            [selectedDisplayFields]="['employeeNameEn']"
                                                            [dataSources]="billingOps"
                                                            [displayFields]="[{'field':'username','label':'User Name'},{'field':'employeeNameEn','label':'Full Name'},{'field':'','label':'Role'}]">
                                                        </app-combo-grid-virtual-scroll>
                                                        <div class="form-control-feedback" style="display: none">
                                                            Billing OPS is required!
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-4 m--margin-top-10 m--margin-bottom-5">
                                                    <span class="m--font-bolder">Create:</span>
                                                    <span
                                                        class="m--font-brand m--margin-left-5">{{ opsTransaction.createdDate | date : "dd/MM/yyyy HH:mm:ss" }}</span>
                                                    <span class="m--font-bolder m--margin-left-5">by</span>
                                                    <span
                                                        class="m--font-brand m--margin-left-5">{{ opsTransaction.userCreated }}</span>
                                                </div>
                                                <div class="col-md-4 m--margin-top-10 m--margin-bottom-5">
                                                    <span class="m--font-bolder">Modified:</span>
                                                    <span
                                                        class="m--font-brand m--margin-left-5">{{ opsTransaction.modifiedDate | date : "dd/MM/yyyy HH:mm:ss" }}</span>
                                                    <span class="m--font-bolder m--margin-left-5">by</span>
                                                    <span
                                                        class="m--font-brand m--margin-left-5">{{ opsTransaction.userModified }}</span>
                                                </div>
                                            </div>
                                        </div>
                                        <!--end:: General Information -->
                                        <!--begin:: Good Information -->
                                        <div class="div-inside bg-secondary">
                                            <h3 class="c-block-title">Good Information</h3>
                                            <hr>
                                            <div class="row">
                                                <div class="col-lg-4">
                                                    <div class="form-group"
                                                        [ngClass]="{'m-form__group has-danger':addOpsForm.submitted && opsTransaction.sumGrossWeight == 0}">
                                                        <label class="form-control-label" for="">
                                                            GW
                                                        </label>
                                                        <input type="number"
                                                            class="form-control m-input m-input--square"
                                                            placeholder="Enter number" name="sumGrossWeight"
                                                            [(ngModel)]="opsTransaction.sumGrossWeight"
                                                            decimalNumberGreaterThan0 #sumGrossWeight="ngModel">
                                                        <div class="form-control-feedback"
                                                            *ngIf="addOpsForm.submitted && opsTransaction.sumGrossWeight == 0">
                                                            Sum of gross weight must be greater than 0
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-lg-4">
                                                    <div class="form-group"
                                                        [ngClass]="{'m-form__group has-danger':addOpsForm.submitted && opsTransaction.sumNetWeight == 0}">
                                                        <label class="form-control-label" for="">
                                                            NW
                                                        </label>
                                                        <input type="number"
                                                            class="form-control m-input m-input--square"
                                                            placeholder="Enter number" name="sumNetWeight"
                                                            [(ngModel)]="opsTransaction.sumNetWeight"
                                                            decimalNumberGreaterThan0 #sumNetWeight="ngModel">
                                                        <div class="form-control-feedback"
                                                            *ngIf="addOpsForm.submitted && opsTransaction.sumNetWeight == 0">
                                                            Sum of net weight must be greater than 0
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-lg-4">
                                                    <div class="form-group"
                                                        [ngClass]="{'m-form__group has-danger':addOpsForm.submitted && opsTransaction.sumCbm == 0}">
                                                        <label class="form-control-label" for="">
                                                            CBM
                                                        </label>
                                                        <input type="number"
                                                            class="form-control m-input m-input--square"
                                                            placeholder="Enter number" name="sumCbm"
                                                            [(ngModel)]="opsTransaction.sumCbm"
                                                            decimalNumberGreaterThan0 #sumCbm="ngModel">
                                                        <div class="form-control-feedback"
                                                            *ngIf="addOpsForm.submitted && opsTransaction.sumCbm == 0">
                                                            Sum of CBM must be greater than 0
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-xl-4">
                                                    <div class="form-group">
                                                        <label class="form-control-label" for="">
                                                            Packages Qty
                                                        </label>
                                                        <div class="input-group m-input-group m-input-group--square">
                                                            <input type="number" class="form-control m-input" min="1"
                                                                aria-label="" name="sumPackages" appIntergerInputCheck
                                                                placeholder="Enter number"
                                                                [(ngModel)]="opsTransaction.sumPackages"
                                                                #sumPackages="ngModel">
                                                            <div class="input-group-prepend">
                                                                <ng-select [allowClear]="false" [items]="packageTypes"
                                                                    [active]="packagesUnitActive" [disabled]="disabled"
                                                                    (data)="refreshValue($event)"
                                                                    (selected)="selected($event)"
                                                                    (removed)="removed($event)" (typed)="typed($event)"
                                                                    placeholder="">
                                                                </ng-select>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-xl-4">
                                                    <div class="form-group">
                                                        <label class="form-control-label" for="">
                                                            Container Qty
                                                        </label>
                                                        <input type="number"
                                                            class="form-control m-input m-input--square" min="1"
                                                            appIntergerInputCheck name="sumContainers"
                                                            placeholder="Enter number"
                                                            [(ngModel)]="opsTransaction.sumContainers"
                                                            #sumContainers="ngModel">
                                                    </div>
                                                </div>
                                                <div class="col-xl-4">
                                                    <div class="m--margin-bottom-15 m--margin-top-25">
                                                        <button type="button"
                                                            class="btn btn-success m-btn--square m-btn--icon m-btn--uppercase"
                                                            (click)="showListContainer()">
                                                            <span>
                                                                <i class="la la-list"></i>
                                                                <span>
                                                                    Container list
                                                                </span>
                                                            </span>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <!--end:: Good Information-->
                                    </div>
                                </div>
                                <!--end::m-portlet -->
                            </div>
                        </form>
                        <!--end::Form-->

                        <div class="row">
                            <div class="col-12">
                                <ul class="nav nav-tabs m-tabs m-tabs-line m-tabs-line--brand m-tabs-line-danger"
                                    role="tablist">
                                    <li class="nav-item m-tabs__item">
                                        <a class="nav-link m-tabs__link active" data-toggle="tab" href="#buying-rate"
                                            role="tab">
                                            Buying Rate
                                        </a>
                                    </li>
                                    <li class="nav-item m-tabs__item">
                                        <a class="nav-link m-tabs__link" data-toggle="tab" href="#selling-rate"
                                            role="tab">
                                            Selling Rate
                                        </a>
                                    </li>
                                    <li class="nav-item m-tabs__item">
                                        <a class="nav-link m-tabs__link" data-toggle="tab" href="#obh-charge"
                                            role="tab">
                                            OBH
                                        </a>
                                    </li>
                                    <li class="nav-item m-tabs__item">
                                        <a class="nav-link m-tabs__link" data-toggle="tab" href="#logistic-charge"
                                            role="tab">
                                            Logistic Charges
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </div>

                        <!--begin:: m-portlet-->
                        <div class="m-portlet">
                            <div class="m-portlet__body">
                                <div class="tab-content" id="">
                                    <!--begin::buying-rate-->
                                    <div class="tab-pane fade show active" id="buying-rate" role="tabpanel">
                                        <!--begin: Search Form -->
                                        <div class="m-form m-form--label-align-right m--margin-bottom-10">
                                            <div class="row align-items-center">
                                                <div class="col-lg-4 order-2 order-lg-1">
                                                    <div class="form-group">
                                                        <div class="m-input-icon m-input-icon--left">
                                                            <input type="text"
                                                                class="form-control m-input m-input--square"
                                                                placeholder="Search..."
                                                                (keyup)="ListBuyingRateCharges = searchCharge($event.target.value,'BUY')">
                                                            <span class="m-input-icon__icon m-input-icon__icon--left">
                                                                <span>
                                                                    <i class="la la-search"></i>
                                                                </span>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div
                                                    class="col-lg-8 order-1 order-lg-2 c-button-actions m--align-right">
                                                    <button type="button"
                                                        class="btn btn-success m-btn--square m-btn--icon m-btn--uppercase"
                                                        data-toggle="modal" data-target="#ops-add-buying-rate-modal">
                                                        <span>
                                                            <i class="la la-plus"></i>
                                                            <span>
                                                                add charge
                                                            </span>
                                                        </span>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        <!--end: Search Form -->
                                        <!--begin: Datatable-->
                                        <div class="table-wrapper table-scrollable fit-height-div-15" id="">
                                            <table class="table table-striped table-brand dataTable">
                                                <thead class="">
                                                    <tr class="">
                                                        <th class=""></th>
                                                        <th class="sorting">
                                                            <span>
                                                                Partner
                                                            </span>
                                                        </th>
                                                        <th class="sorting">
                                                            <span>
                                                                Name EN
                                                            </span>
                                                        </th>
                                                        <th class="sorting">
                                                            <span>
                                                                Quantity
                                                            </span>
                                                        </th>
                                                        <th class="sorting">
                                                            <span>
                                                                Unit
                                                            </span>
                                                        </th>
                                                        <th class="sorting">
                                                            <span>
                                                                Unit price
                                                            </span>
                                                        </th>

                                                        <th class="sorting">
                                                            <span>
                                                                Currency
                                                            </span>
                                                        </th>
                                                        <th class="">
                                                            <span>
                                                                VAT
                                                            </span>
                                                        </th>
                                                        <th class="">
                                                            <span>
                                                                Total
                                                            </span>
                                                        </th>
                                                        <th class="">
                                                            <span>
                                                                Note
                                                            </span>
                                                        </th>
                                                        <th class="">
                                                            <span>
                                                                Docs
                                                            </span>
                                                        </th>
                                                        <th class="sorting">
                                                            <span>
                                                                SOA
                                                            </span>
                                                        </th>
                                                        <th class="sorting">
                                                            <span>
                                                                Credit/ Debit note
                                                            </span>
                                                        </th>
                                                        <th class="sorting">
                                                            <span>
                                                                Settle payment
                                                            </span>
                                                        </th>
                                                        <th class="sorting">
                                                            <span>
                                                                Exchange rate date
                                                            </span>
                                                        </th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr class=""
                                                        *ngFor="let charge of ListBuyingRateCharges;let i = index;">
                                                        <td class="table-actions-col">
                                                            <div class="table-actions" style="width: 70px">
                                                                <button type="button"
                                                                    (click)="prepareEditCharge('BUY',charge)"
                                                                    class="btn btn-success btn-sm m-btn--square m-btn--icon m-btn--icon-only"
                                                                    title="Edit" data-toggle="modal"
                                                                    data-target="#ops-edit-buying-rate-modal">
                                                                    <i class="la la-edit"></i>
                                                                </button>
                                                                <button type="button"
                                                                    (click)="DeleteCharge('confirm',charge.id)"
                                                                    class="btn btn-danger btn-sm m-btn--square m-btn--icon m-btn--icon-only"
                                                                    title="Remove" data-toggle="modal"
                                                                    data-target="#ops-confirm-delete-charge-modal">
                                                                    <i class="la la-trash"></i>
                                                                </button>
                                                            </div>
                                                        </td>
                                                        <td>
                                                            <span>
                                                                {{charge.partnerName}}
                                                            </span>
                                                        </td>
                                                        <td>
                                                            <!-- <span>
                                                    {{charge.nameEn}}
                                                </span> -->
                                                            <a href="javascript:void()"
                                                                (click)="prepareEditCharge('BUY',charge)"
                                                                data-toggle="modal"
                                                                data-target="#ops-edit-buying-rate-modal">{{charge.nameEn}}</a>
                                                        </td>
                                                        <td>
                                                            <span>
                                                                {{charge.quantity}}
                                                            </span>
                                                        </td>
                                                        <td>
                                                            <span>
                                                                {{charge.unit}}
                                                            </span>
                                                        </td>
                                                        <td>
                                                            <span>
                                                                {{charge.unitPrice}}
                                                            </span>
                                                        </td>

                                                        <td>
                                                            <span>
                                                                {{charge.currency}}
                                                            </span>
                                                        </td>
                                                        <td>
                                                            <span>
                                                                {{charge.vatrate}}
                                                            </span>
                                                        </td>
                                                        <td>
                                                            <span>
                                                                {{charge.total}}
                                                            </span>
                                                        </td>
                                                        <td>
                                                            <span>
                                                                {{charge.notes}}
                                                            </span>
                                                        </td>
                                                        <td>
                                                            <span>
                                                                {{charge.docNo}}
                                                            </span>
                                                        </td>
                                                        <td>
                                                            <span>
                                                                {{charge.soano}}
                                                            </span>
                                                        </td>
                                                        <td>
                                                            <a href="javascript:void(0)" data-toggle="modal"
                                                                data-target="#detail-credit-debit-note-modal"
                                                                (click)="openCreditDebitNote()">
                                                                Credit/ Debit note
                                                            </a>
                                                        </td>
                                                        <td>
                                                            <span>
                                                                <!-- Settle payment -->
                                                            </span>
                                                        </td>
                                                        <td>
                                                            <span>
                                                                {{charge.exchangeDate | date:'dd/MM/yyyy'}}
                                                            </span>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                        <!--end: Datatable-->
                                    </div>
                                    <!--end::buying-rate-->

                                    <!--begin::selling-rate-->
                                    <div class="tab-pane fade" id="selling-rate" role="tabpanel">
                                        <!--begin: Search Form -->
                                        <div class="m-form m-form--label-align-right m--margin-bottom-10">
                                            <div class="row align-items-center">
                                                <div class="col-lg-4 order-2 order-lg-1">
                                                    <div class="form-group">
                                                        <div class="m-input-icon m-input-icon--left">
                                                            <input type="text"
                                                                class="form-control m-input m-input--square"
                                                                placeholder="Search..."
                                                                (keyup)="ListSellingRateCharges = searchCharge($event.target.value,'SELL')">
                                                            <span class="m-input-icon__icon m-input-icon__icon--left">
                                                                <span>
                                                                    <i class="la la-search"></i>
                                                                </span>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div
                                                    class="col-lg-8 order-1 order-lg-2 c-button-actions m--align-right">
                                                    <button type="button"
                                                        class="btn btn-success m-btn--square m-btn--icon m-btn--uppercase"
                                                        data-toggle="modal" data-target="#ops-add-selling-rate-modal">
                                                        <span>
                                                            <i class="la la-plus"></i>
                                                            <span>
                                                                add charge
                                                            </span>
                                                        </span>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        <!--end: Search Form -->
                                        <!--begin: Datatable-->
                                        <div class="table-wrapper table-scrollable fit-height-div-15" id="">
                                            <table class="table table-striped table-brand dataTable">
                                                <thead class="">
                                                    <tr class="">
                                                        <th class=""></th>
                                                        <th class="sorting">
                                                            <span>
                                                                Partner
                                                            </span>
                                                        </th>
                                                        <th class="sorting">
                                                            <span>
                                                                Name EN
                                                            </span>
                                                        </th>
                                                        <th class="sorting">
                                                            <span>
                                                                Quantity
                                                            </span>
                                                        </th>
                                                        <th class="sorting">
                                                            <span>
                                                                Unit
                                                            </span>
                                                        </th>
                                                        <th class="sorting">
                                                            <span>
                                                                Unit Price
                                                            </span>
                                                        </th>
                                                        <th class="sorting">
                                                            <span>
                                                                Currency
                                                            </span>
                                                        </th>
                                                        <th class="">
                                                            <span>
                                                                VAT
                                                            </span>
                                                        </th>
                                                        <th class="">
                                                            <span>
                                                                Total
                                                            </span>
                                                        </th>
                                                        <th class="">
                                                            <span>
                                                                Note
                                                            </span>
                                                        </th>
                                                        <th class="">
                                                            <span>
                                                                Docs
                                                            </span>
                                                        </th>
                                                        <th class="sorting">
                                                            <span>
                                                                SOA
                                                            </span>
                                                        </th>
                                                        <th class="sorting">
                                                            <span>
                                                                Credit/ Debit note
                                                            </span>
                                                        </th>
                                                        <th class="sorting">
                                                            <span>
                                                                Settle payment
                                                            </span>
                                                        </th>
                                                        <th class="sorting">
                                                            <span>
                                                                Exchange rate date
                                                            </span>
                                                        </th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr class=""
                                                        *ngFor="let charge of ListSellingRateCharges;let i = index;">
                                                        <td class="table-actions-col">
                                                            <div class="table-actions" style="width: 70px">
                                                                <button type="button"
                                                                    (click)="prepareEditCharge('SELL',charge)"
                                                                    class="btn btn-success btn-sm m-btn--square m-btn--icon m-btn--icon-only"
                                                                    title="Edit" data-toggle="modal"
                                                                    data-target="#ops-edit-selling-rate-modal">
                                                                    <i class="la la-edit"></i>
                                                                </button>
                                                                <button type="button"
                                                                    (click)="DeleteCharge('confirm',charge.id)"
                                                                    class="btn btn-danger btn-sm m-btn--square m-btn--icon m-btn--icon-only"
                                                                    title="Remove" data-toggle="modal"
                                                                    data-target="#ops-confirm-delete-charge-modal">
                                                                    <i class="la la-trash"></i>
                                                                </button>
                                                            </div>
                                                        </td>
                                                        <td>
                                                            <span>
                                                                {{charge.partnerName}}
                                                            </span>
                                                        </td>
                                                        <td>
                                                            <a href="javascript:void()"
                                                                (click)="prepareEditCharge('SELL',charge)"
                                                                data-toggle="modal"
                                                                data-target="#ops-edit-selling-rate-modal">{{charge.nameEn}}</a>
                                                        </td>
                                                        <td>
                                                            <span>
                                                                {{charge.quantity}}
                                                            </span>
                                                        </td>
                                                        <td>
                                                            <span>
                                                                {{charge.unit}}
                                                            </span>
                                                        </td>
                                                        <td>
                                                            <span>
                                                                {{charge.unitPrice}}
                                                            </span>
                                                        </td>

                                                        <td>
                                                            <span>
                                                                {{charge.currency}}
                                                            </span>
                                                        </td>
                                                        <td>
                                                            <span>
                                                                {{charge.vatrate}}
                                                            </span>
                                                        </td>
                                                        <td>
                                                            <span>
                                                                {{charge.total}}
                                                            </span>
                                                        </td>
                                                        <td>
                                                            <span>
                                                                {{charge.notes}}
                                                            </span>
                                                        </td>
                                                        <td>
                                                            <span>
                                                                {{charge.docNo}}
                                                            </span>
                                                        </td>
                                                        <td>
                                                            <span>
                                                                {{charge.soano}}
                                                            </span>
                                                        </td>
                                                        <td>
                                                            <a href="javascript:void(0)" data-toggle="modal"
                                                                data-target="#detail-credit-debit-note-modal"
                                                                (click)="openCreditDebitNote()">
                                                                Credit/ Debit note
                                                            </a>
                                                        </td>
                                                        <td>
                                                            <span>
                                                                <!-- Settle payment -->
                                                            </span>
                                                        </td>
                                                        <td>
                                                            <span>
                                                                {{charge.exchangeDate | date:'dd/MM/yyyy'}}
                                                            </span>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                        <!--end: Datatable-->
                                    </div>
                                    <!--end::selling-rate-->

                                    <!--begin::obh-charge-->
                                    <div class="tab-pane fade" id="obh-charge" role="tabpanel">
                                        <!--begin: Search Form -->
                                        <div class="m-form m-form--label-align-right m--margin-bottom-10">
                                            <div class="row align-items-center">
                                                <div class="col-lg-6 order-2 order-lg-1">
                                                    <div class="form-group">
                                                        <div class="m-input-icon m-input-icon--left">
                                                            <input type="text"
                                                                class="form-control m-input m-input--square"
                                                                placeholder="Search..."
                                                                (keyup)="ListOBHCharges=searchCharge($event.target.value,'OBH')">
                                                            <span class="m-input-icon__icon m-input-icon__icon--left">
                                                                <span>
                                                                    <i class="la la-search"></i>
                                                                </span>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div
                                                    class="col-lg-6 order-1 order-lg-2 c-button-actions m--align-right">
                                                    <button type="button"
                                                        class="btn btn-success m-btn--square m-btn--icon m-btn--uppercase"
                                                        data-toggle="modal" data-target="#ops-add-obh-charge-modal">
                                                        <span>
                                                            <i class="la la-plus"></i>
                                                            <span>
                                                                add charge
                                                            </span>
                                                        </span>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        <!--end: Search Form -->
                                        <!--begin: Datatable-->
                                        <div class="table-wrapper table-scrollable fit-height-div-15" id="">
                                            <table class="table table-striped table-brand dataTable">
                                                <thead class="">
                                                    <tr class="">
                                                        <th class=""></th>
                                                        <th class="sorting">
                                                            <span>
                                                                Receiver
                                                            </span>
                                                        </th>
                                                        <th class="sorting">
                                                            <span>
                                                                Payer
                                                            </span>
                                                        </th>
                                                        <th class="sorting">
                                                            <span>
                                                                Name EN
                                                            </span>
                                                        </th>
                                                        <th class="sorting">
                                                            <span>
                                                                Quantity
                                                            </span>
                                                        </th>
                                                        <th class="sorting">
                                                            <span>
                                                                Unit
                                                            </span>
                                                        </th>
                                                        <th class="sorting">
                                                            <span>
                                                                Unit price
                                                            </span>
                                                        </th>
                                                        <th class="sorting">
                                                            <span>
                                                                Currency
                                                            </span>
                                                        </th>
                                                        <th class="">
                                                            <span>
                                                                VAT
                                                            </span>
                                                        </th>
                                                        <th class="">
                                                            <span>
                                                                Total
                                                            </span>
                                                        </th>
                                                        <th class="">
                                                            <span>
                                                                Note
                                                            </span>
                                                        </th>
                                                        <th class="">
                                                            <span>
                                                                Docs
                                                            </span>
                                                        </th>
                                                        <th class="sorting">
                                                            <span>
                                                                SOA
                                                            </span>
                                                        </th>
                                                        <th class="sorting">
                                                            <span>
                                                                Credit/ Debit note
                                                            </span>
                                                        </th>
                                                        <th class="sorting">
                                                            <span>
                                                                Settle payment
                                                            </span>
                                                        </th>
                                                        <th class="sorting">
                                                            <span>
                                                                Exchange rate date
                                                            </span>
                                                        </th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr class="" *ngFor="let charge of ListOBHCharges;let i = index;">
                                                        <td class="table-actions-col">
                                                            <div class="table-actions" style="width: 70px">
                                                                <button type="button"
                                                                    (click)="prepareEditCharge('OBH',charge)"
                                                                    class="btn btn-success btn-sm m-btn--square m-btn--icon m-btn--icon-only"
                                                                    title="Edit" data-toggle="modal"
                                                                    data-target="#ops-edit-obh-charge-modal">
                                                                    <i class="la la-edit"></i>
                                                                </button>
                                                                <button type="button"
                                                                    (click)="DeleteCharge('confirm',charge.id)"
                                                                    class="btn btn-danger btn-sm m-btn--square m-btn--icon m-btn--icon-only"
                                                                    title="Remove" data-toggle="modal"
                                                                    data-target="#ops-confirm-delete-charge-modal">
                                                                    <i class="la la-trash"></i>
                                                                </button>
                                                            </div>
                                                        </td>
                                                        <td>
                                                            <span>
                                                                {{charge.receiverName}}
                                                            </span>
                                                        </td>
                                                        <td>
                                                            <span>
                                                                {{charge.payerName}}
                                                            </span>
                                                        </td>
                                                        <td>
                                                            <a href="javascript:void()"
                                                                (click)="prepareEditCharge('OBH',charge)"
                                                                data-toggle="modal"
                                                                data-target="#ops-edit-obh-charge-modal">{{charge.nameEn}}</a>
                                                        </td>
                                                        <td>
                                                            <span>
                                                                {{charge.quantity}}
                                                            </span>
                                                        </td>
                                                        <td>
                                                            <span>
                                                                {{charge.unit}}
                                                            </span>
                                                        </td>
                                                        <td>
                                                            <span>
                                                                {{charge.unitPrice}}
                                                            </span>
                                                        </td>

                                                        <td>
                                                            <span>
                                                                {{charge.currency}}
                                                            </span>
                                                        </td>
                                                        <td>
                                                            <span>
                                                                {{charge.vatrate}}
                                                            </span>
                                                        </td>
                                                        <td>
                                                            <span>
                                                                {{charge.total}}
                                                            </span>
                                                        </td>
                                                        <td>
                                                            <span>
                                                                {{charge.notes}}
                                                            </span>
                                                        </td>
                                                        <td>
                                                            <span>
                                                                {{charge.docNo}}
                                                            </span>
                                                        </td>
                                                        <td>
                                                            <span>
                                                                {{charge.soano}}
                                                            </span>
                                                        </td>
                                                        <td>
                                                            <a href="javascript:void(0)" data-toggle="modal"
                                                                data-target="#detail-credit-debit-note-modal">
                                                                Credit/ Debit note
                                                            </a>
                                                        </td>
                                                        <td>
                                                            <span>
                                                                <!-- Settle payment -->
                                                            </span>
                                                        </td>
                                                        <td>
                                                            <span>
                                                                {{charge.exchangeDate | date:'dd/MM/yyyy'}}
                                                            </span>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                        <!--end: Datatable-->
                                    </div>
                                    <!--end::obh-charge-->

                                    <!--begin::logistic-charge-->
                                    <div class="tab-pane fade" id="logistic-charge" role="tabpanel">
                                        <!--begin: Search Form -->
                                        <div class="m-form m-form--label-align-right m--margin-bottom-10">
                                            <div class="row align-items-center">
                                                <div class="col-lg-6 order-2 order-lg-1">
                                                    <div class="form-group">
                                                        <div class="m-input-icon m-input-icon--left">
                                                            <input type="text"
                                                                class="form-control m-input m-input--square"
                                                                placeholder="Search...">
                                                            <span class="m-input-icon__icon m-input-icon__icon--left">
                                                                <span>
                                                                    <i class="la la-search"></i>
                                                                </span>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <!--end: Search Form -->
                                        <!--begin: Datatable-->
                                        <div class="table-wrapper table-scrollable fit-height-div-15" id="">
                                            <table class="table table-striped table-brand dataTable">
                                                <thead class="">
                                                    <tr class="">
                                                        <th class="sorting">
                                                            <span>
                                                                Partner
                                                            </span>
                                                        </th>
                                                        <th class="sorting">
                                                            <span>
                                                                Name EN
                                                            </span>
                                                        </th>
                                                        <th class="sorting">
                                                            <span>
                                                                Quantity
                                                            </span>
                                                        </th>
                                                        <th class="sorting">
                                                            <span>
                                                                Unit
                                                            </span>
                                                        </th>
                                                        <th class="sorting">
                                                            <span>
                                                                Unit price
                                                            </span>
                                                        </th>

                                                        <th class="sorting">
                                                            <span>
                                                                Currency
                                                            </span>
                                                        </th>
                                                        <th class="">
                                                            <span>
                                                                VAT
                                                            </span>
                                                        </th>
                                                        <th class="">
                                                            <span>
                                                                Total
                                                            </span>
                                                        </th>
                                                        <th class="">
                                                            <span>
                                                                Note
                                                            </span>
                                                        </th>
                                                        <th class="">
                                                            <span>
                                                                Docs
                                                            </span>
                                                        </th>
                                                        <th class="sorting">
                                                            <span>
                                                                SOA
                                                            </span>
                                                        </th>
                                                        <th class="sorting">
                                                            <span>
                                                                Credit/ Debit note
                                                            </span>
                                                        </th>
                                                        <th class="sorting">
                                                            <span>
                                                                Settle payment
                                                            </span>
                                                        </th>
                                                        <th class="sorting">
                                                            <span>
                                                                Exchange rate date
                                                            </span>
                                                        </th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr class="">
                                                        <td>
                                                            <span>
                                                                Partner
                                                            </span>
                                                        </td>
                                                        <td>
                                                            <span>
                                                                Name EN
                                                            </span>
                                                        </td>
                                                        <td>
                                                            <span>
                                                                Quantity
                                                            </span>
                                                        </td>
                                                        <td>
                                                            <span>
                                                                Unit
                                                            </span>
                                                        </td>
                                                        <td>
                                                            <span>
                                                                Unit price
                                                            </span>
                                                        </td>
                                                        <td>
                                                            <span>
                                                                Currency
                                                            </span>
                                                        </td>
                                                        <td>
                                                            <span>
                                                                VAT
                                                            </span>
                                                        </td>
                                                        <td>
                                                            <span>
                                                                Total
                                                            </span>
                                                        </td>
                                                        <td>
                                                            <span>
                                                                Note
                                                            </span>
                                                        </td>
                                                        <td>
                                                            <span>
                                                                Docs
                                                            </span>
                                                        </td>
                                                        <td>
                                                            <span>
                                                                SOA
                                                            </span>
                                                        </td>
                                                        <td>
                                                            <a href="javascript:void(0)" data-toggle="modal"
                                                                data-target="#detail-credit-debit-note-modal">
                                                                Credit/ Debit note
                                                            </a>
                                                        </td>
                                                        <td>
                                                            <span>
                                                                Settle payment
                                                            </span>
                                                        </td>
                                                        <td>
                                                            <span>
                                                                Exchange rate date
                                                            </span>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                        <!--end: Datatable-->
                                    </div>
                                    <!--end::logistic-charge-->
                                </div>
                            </div>
                        </div>
                        <!--end:: m-portlet-->

                        <!--begin:: m-portlet-->
                        <div class="m-portlet m-portlet--danger m-portlet--head-solid-bg m-portlet--bordered">
                            <div class="alert-block__heading">
                                <h3 class="alert-block__title collapse-toggle" data-toggle="collapse"
                                    data-target="#profit-summary">
                                    <i class="la la-angle-up m--margin-right-5"></i> Profit summary
                                </h3>
                            </div>
                            <div class="m-portlet__body">
                                <div class="collapse show" id="profit-summary">
                                    <!--begin: table -->
                                    <div class="table-wrapper" id="">
                                        <table class="table table-striped table-brand">
                                            <thead>
                                                <tr>
                                                    <th>Type</th>
                                                    <th>
                                                        <span>USD</span>
                                                    </th>
                                                    <th>
                                                        <span>Local (VN)</span>
                                                    </th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>
                                                        <span>Buying rate</span>
                                                    </td>
                                                    <td>
                                                        <span>{{totalBuyingUSD | number : '1.3-3'}}</span>
                                                    </td>
                                                    <td>
                                                        <span>{{totalBuyingLocal | number : '1.3-3'}}</span>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>
                                                        <span>Selling rate</span>
                                                    </td>
                                                    <td>
                                                        <span>{{totalSellingUSD | number : '1.3-3'}}</span>
                                                    </td>
                                                    <td>
                                                        <span>{{totalSellingLocal | number : '1.3-3'}}</span>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>
                                                        <span>OBH</span>
                                                    </td>
                                                    <td>
                                                        <span>{{totalOBHUSD | number : '1.3-3'}}</span>
                                                    </td>
                                                    <td>
                                                        <span>{{totalOBHLocal | number : '1.3-3'}}</span>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>
                                                        <span>Logictis charge</span>
                                                    </td>
                                                    <td>
                                                        <span>{{totalLogisticChargeUSD | number : '1.3-3'}}</span>
                                                    </td>
                                                    <td>
                                                        <span>{{totalLogisticChargeLocal | number : '1.3-3'}}</span>
                                                    </td>
                                                </tr>
                                            </tbody>
                                            <tfoot>
                                                <tr>
                                                    <th>
                                                        <span>Total</span>
                                                    </th>
                                                    <th>
                                                        <span>{{totalProfitUSD | number : '1.3-3'}}</span>
                                                    </th>
                                                    <th>
                                                        <span>{{totalProfitLocal | number : '1.3-3'}}</span>
                                                    </th>
                                                </tr>
                                            </tfoot>
                                        </table>
                                    </div>
                                    <!--end: table -->
                                </div>
                            </div>
                        </div>
                        <!--end:: m-portlet-->
                    </div>
                </tab>
                <tab heading="Custom declaration" (selectTab)="selectTab($event,'custom-declaration')">
                    <app-billing-custom-declaration *ngIf="tab === 'custom-declaration'" [currentJob]="opsTransaction">
                    </app-billing-custom-declaration>
                </tab>
                <tab heading="Credit Note & Debit Note" (selectTab)="selectTab($event,'cre-debit-note')">
                    <app-ops-module-credit-debit-note *ngIf="tab === 'cre-debit-note'">
                    </app-ops-module-credit-debit-note>
                </tab>
                <tab heading="Stage management" [active]="tab === 'stage'" (selectTab)="selectTab($event, 'stage')">
                    <app-ops-module-stage-management *ngIf="tab === 'stage'" [data]="opsTransaction">
                    </app-ops-module-stage-management>
                </tab>
            </tabset>
        </div>
    </div>
</div>
<!--end:: m-content-->

<!--begin::container-list-of-ops-billing-modal-->
<div class="modal fade" id="container-list-of-ops-billing-modal" data-backdrop="static" role="dialog" aria-labelledby=""
    aria-hidden="true">
    <div class="modal-dialog c-modal-fullscreen" role="document">
        <form novalidate #containerMasterForm="ngForm" (ngSubmit)="containerMasterForm.form.valid">
            <div class="modal-content m-form m-form--state">
                <div class="modal-header">
                    <h5 class="modal-title">List of container</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"
                        (click)="closeContainerPopup()">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="container-list-table">
                        <!--begin: Search Form -->
                        <div class="m-form m-form--label-align-right m--margin-bottom-10">
                            <div class="row align-items-center">
                                <div class="col-lg-4 order-2 order-lg-1">
                                    <div class="form-group">
                                        <div class="m-input-icon m-input-icon--left">
                                            <input type="text" class="form-control m-input m-input--square"
                                                [ngModel]="searchcontainer"
                                                (change)="searchcontainer = searchcontainer.trim()"
                                                (ngModelChange)="searchContainer($event)" placeholder="Search..."
                                                autocomplete="nope" name="searchcontainer">
                                            <span class="m-input-icon__icon m-input-icon__icon--left">
                                                <span>
                                                    <i class="la la-search"></i>
                                                </span>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-8 order-1 order-lg-2 c-button-actions m--align-right">
                                    <button type="button"
                                        class="btn btn-brand m-btn--square m-btn--icon m-btn--uppercase">
                                        <span>
                                            <i class="la la-download"></i>
                                            <span>
                                                import
                                            </span>
                                        </span>
                                    </button>
                                    <button type="button" (click)="addNewContainer()"
                                        class="btn btn-success m-btn--square m-btn--icon m-btn--uppercase">
                                        <span>
                                            <i class="la la-plus"></i>
                                            <span>
                                                add container
                                            </span>
                                        </span>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <!--end: Search Form -->
                        <!--begin: Datatable -->
                        <div class="table-wrapper" id="" style="min-height: 300px">
                            <table class="table table-striped table-brand table-editable">
                                <thead class="">
                                    <tr class="">
                                        <th class="fixed-side"></th>
                                        <th class="">
                                            <span>
                                                Cont Type <span class="m--font-danger">(*)</span>
                                            </span>
                                        </th>
                                        <th class="">
                                            <span>
                                                Cont Q'ty <span class="m--font-danger">(*)</span>
                                            </span>
                                        </th>
                                        <th class="">
                                            <span>
                                                Cont No.
                                            </span>
                                        </th>
                                        <th class="">
                                            <span>
                                                Seal No.
                                            </span>
                                        </th>
                                        <th class="">
                                            <span>
                                                Mark No.
                                            </span>
                                        </th>
                                        <th class="">
                                            <span>
                                                Commodity
                                            </span>
                                        </th>
                                        <th class="">
                                            <span>
                                                Package Type
                                            </span>
                                        </th>
                                        <th class="">
                                            <span>
                                                Package Q'ty
                                            </span>
                                        </th>
                                        <th class="">
                                            <span>
                                                Description of Good
                                            </span>
                                        </th>
                                        <th class="">
                                            <span>
                                                G.W
                                            </span>
                                        </th>
                                        <th class="">
                                            <span>
                                                N.W
                                            </span>
                                        </th>
                                        <th class="">
                                            <span>
                                                C.W
                                            </span>
                                        </th>
                                        <th class="">
                                            <span>
                                                Unit
                                            </span>
                                        </th>
                                        <th class="">
                                            <span>
                                                CBM
                                            </span>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody *ngIf="lstMasterContainers">
                                    <ng-container *ngFor="let container of lstMasterContainers; let i= index">
                                        <tr class="m-form m-form--state row-editing" *ngIf="container.allowEdit"
                                            [ngClass]="{ 'invalid-row': container.inValidRow }">
                                            <td class="table-actions-col fixed-side">
                                                <div class="table-actions control-editable" style="width: 70px">
                                                    <button type=""
                                                        class="btn btn-primary btn-sm m-btn--square m-btn--icon m-btn--icon-only"
                                                        title="Save" (click)="saveNewContainer(i)">
                                                        <i class="la la-save"></i>
                                                    </button>
                                                    <button type="button"
                                                        class="btn btn-danger btn-sm m-btn--square m-btn--icon m-btn--icon-only"
                                                        title="Cancel" (click)="cancelNewContainer(i)">
                                                        <i class="la la-ban"></i>
                                                    </button>
                                                </div>
                                            </td>
                                            <td class="">
                                                <div class="control-editable"
                                                    [ngClass]="{ 'has-danger': containerMasterForm.submitted && container.containerTypeId == null && container.verifying}">
                                                    <ng-select [allowClear]="true" [items]="containerTypes"
                                                        #containerSelect id="containerSelect"
                                                        (data)="refreshValue($event)"
                                                        (selected)="container.containerTypeId = $event.id;container.containerTypeName = $event.text"
                                                        (removed)="container.containerTypeId = null;container.containerTypeName = null"
                                                        (typed)="typed($event)" [active]="container.containerTypeActive"
                                                        placeholder="Select filter">
                                                    </ng-select>
                                                    <div class="form-control-feedback"
                                                        *ngIf="containerMasterForm.submitted && container.containerTypeId == null && container.verifying">
                                                        Container type is required.
                                                    </div>
                                                </div>
                                                <div class="has-danger row-control-feedback"
                                                    *ngIf="container.inValidRow">
                                                    <div class="form-control-feedback">
                                                        Duplicate container detail
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="">
                                                <div class="control-editable"
                                                    [ngClass]="{ 'has-danger': containerMasterForm.submitted && conQuantity.invalid && container.verifying}">
                                                    <input type="number" class="form-control m-input m-input--square"
                                                        min="1" max="2147483647" value="1" appIntergerInputCheck
                                                        placeholder="Enter number" [(ngModel)]="container.quantity"
                                                        name="conQuantity" #conQuantity="ngModel" required>
                                                    <div class="form-control-feedback"
                                                        *ngIf="containerMasterForm.submitted && conQuantity.invalid && container.verifying">
                                                        Cont Q'ty must be a number
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="">
                                                <div class="control-editable">
                                                    <input type="text" class="form-control m-input m-input--square"
                                                        placeholder="Enter text" autocomplete="nope"
                                                        [(ngModel)]="container.containerNo"
                                                        (change)="container.containerNo = container.containerNo.trim()"
                                                        name="containerNo" #containerNo="ngModel">
                                                </div>
                                            </td>
                                            <td class="">
                                                <div class="control-editable">
                                                    <input type="text" class="form-control m-input m-input--square"
                                                        placeholder="Enter text" autocomplete="nope"
                                                        [(ngModel)]="container.sealNo" name="sealNo"
                                                        (change)="container.sealNo = container.sealNo.trim()"
                                                        #sealNo="ngModel">
                                                </div>
                                            </td>
                                            <td class="">
                                                <div class="control-editable">
                                                    <input type="text" class="form-control m-input m-input--square"
                                                        placeholder="Enter text" autocomplete="nope"
                                                        [(ngModel)]="container.markNo" name="markNo"
                                                        (change)="container.markNo = container.markNo.trim()"
                                                        #markNo="ngModel">
                                                </div>
                                            </td>
                                            <td class="">
                                                <div class="control-editable">

                                                    <app-combo-grid-virtual-scroll
                                                        [currentActiveItemId]="{field:'id',value:container.commodityId}"
                                                        (itemSelected)="container.commodityId=$event.id;container.commodityName=$event.commodityNameEn"
                                                        [selectedDisplayFields]="['commodityNameEn']"
                                                        [dataSources]="commodities"
                                                        [displayFields]="[{'field':'commodityNameEn','label':'Name EN'},{'field':'commodityNameVn','label':'Name VN'},{'field':'commodityGroupNameEn','label':'Group'}]">
                                                    </app-combo-grid-virtual-scroll>
                                                </div>
                                            </td>
                                            <td class="">
                                                <div class="control-editable">
                                                    <ng-select [allowClear]="true" [items]="packageTypes"
                                                        (data)="refreshValue($event)"
                                                        (selected)="container.packageTypeId = $event.id; container.packageTypeName = $event.text"
                                                        (removed)="container.packageTypeId = null; container.packageTypeName = null"
                                                        (typed)="typed($event)" [active]="container.packageTypeActive"
                                                        placeholder="Select filter">
                                                    </ng-select>
                                                </div>
                                            </td>
                                            <td class="">
                                                <div class="control-editable">
                                                    <input type="number" class="form-control m-input m-input--square"
                                                        min="1" max="32767" [(ngModel)]="container.packageQuantity"
                                                        name="packageQuantity" #packageQuantity="ngModel"
                                                        oninput="validity.valid||(value='');" placeholder="Enter number"
                                                        autocomplete="nope">
                                                </div>
                                            </td>
                                            <td class="" style="width: 130px">
                                                <div class="control-editable">
                                                    <input type="text" class="form-control m-input m-input--square"
                                                        autocomplete="nope" [(ngModel)]="container.description"
                                                        name="descriptionOfGood" #descriptionOfGood="ngModel"
                                                        (change)="container.description = container.description.trim()"
                                                        placeholder="Enter text">
                                                </div>
                                            </td>
                                            <td class="">
                                                <div class="control-editable"
                                                    [ngClass]="{ 'has-danger': containerMasterForm.submitted && container.gw == 0}">
                                                    <input type="number" class="form-control m-input m-input--square"
                                                        placeholder="Enter number" autocomplete="nope"
                                                        [(ngModel)]="container.gw" name="containerGW" min="0.01"
                                                        decimalNumberGreaterThan0 #containerGW="ngModel">
                                                    <div class="form-control-feedback"
                                                        *ngIf="containerMasterForm.submitted && container.gw == 0">
                                                        Gross weight must be greater than 0.
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="">
                                                <div class="control-editable"
                                                    [ngClass]="{ 'has-danger': containerMasterForm.submitted && container.nw == 0}">
                                                    <input type="number" class="form-control m-input m-input--square"
                                                        placeholder="Enter number" autocomplete="nope"
                                                        [(ngModel)]="container.nw" name="containerNW" min="0.01"
                                                        decimalNumberGreaterThan0 #containerNW="ngModel">
                                                    <div class="form-control-feedback"
                                                        *ngIf="containerMasterForm.submitted && container.nw == 0">
                                                        Net weight must be greater than 0.
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="">
                                                <div class="control-editable"
                                                    [ngClass]="{ 'has-danger': containerMasterForm.submitted && container.chargeAbleWeight == 0}">
                                                    <input type="number" class="form-control m-input m-input--square"
                                                        placeholder="Enter number" autocomplete="nope"
                                                        [(ngModel)]="container.chargeAbleWeight"
                                                        name="containerchargeAbleWeight" min="0.01"
                                                        decimalNumberGreaterThan0 #containerchargeAbleWeight="ngModel">
                                                    <div class="form-control-feedback"
                                                        *ngIf="containerMasterForm.submitted && container.chargeAbleWeight == 0">
                                                        Chargeable weight must be greater than 0.
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="">
                                                <div class="control-editable">
                                                    <ng-select [allowClear]="true" [items]="weightMesurements"
                                                        (data)="refreshValue($event)"
                                                        (selected)="container.unitOfMeasureId = $event.id; container.unitOfMeasureName = $event.text"
                                                        (removed)="container.unitOfMeasureId = null; container.unitOfMeasureName = null"
                                                        (typed)="typed($event)" [active]="container.unitOfMeasureActive"
                                                        placeholder="Select filter">
                                                    </ng-select>
                                                </div>
                                            </td>
                                            <td class="">
                                                <div class="control-editable"
                                                    [ngClass]="{ 'has-danger': containerMasterForm.submitted && container.cbm == 0}">
                                                    <input type="number" class="form-control m-input m-input--square"
                                                        placeholder="Enter number" autocomplete="nope"
                                                        [(ngModel)]="container.cbm" name="containerCBM" min="0.01"
                                                        appTwoDigitDecimaNumber #containerCBM="ngModel">
                                                    <div class="form-control-feedback"
                                                        *ngIf="containerMasterForm.submitted && container.cbm == 0">
                                                        CBM must be greater than 0.
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr class="" *ngIf="!container.allowEdit">
                                            <td class="table-actions-col fixed-side">
                                                <div class="table-actions" style="width: 70px">
                                                    <button type="button"
                                                        class="btn btn-success btn-sm m-btn--square m-btn--icon m-btn--icon-only"
                                                        title="Edit" (click)="changeEditMode(i)">
                                                        <i class="la la-edit"></i>
                                                    </button>
                                                    <button type="button"
                                                        class="btn btn-danger btn-sm m-btn--square m-btn--icon m-btn--icon-only"
                                                        title="Remove" data-toggle="modal"
                                                        data-target="#confirm-accept-delete-container-modal"
                                                        (click)="removeAContainer(i)">
                                                        <i class="la la-trash"></i>
                                                    </button>
                                                </div>
                                            </td>
                                            <td class="">
                                                <span class="content-editable">
                                                    {{ container.containerTypeName }}
                                                </span>
                                            </td>
                                            <td class="">
                                                <span class="content-editable">
                                                    {{ container.quantity }}
                                                </span>
                                            </td>
                                            <td class="">
                                                <span class="content-editable">
                                                    {{ container.containerNo }}
                                                </span>
                                            </td>
                                            <td class="">
                                                <span class="content-editable">
                                                    {{ container.sealNo }}
                                                </span>
                                            </td>
                                            <td class="">
                                                <span class="content-editable">
                                                    {{ container.markNo }}
                                                </span>
                                            </td>
                                            <td class="">
                                                <span class="content-editable">
                                                    {{ container.commodityName }}
                                                </span>
                                            </td>
                                            <td class="">
                                                <span class="content-editable">
                                                    {{ container.packageTypeName }}
                                                </span>
                                            </td>
                                            <td class="">
                                                <span class="content-editable">
                                                    {{ container.packageQuantity }}
                                                </span>
                                            </td>
                                            <td class="" style="width: 130px">
                                                <span class="content-editable">
                                                    {{ container.description }}
                                                </span>
                                            </td>
                                            <td class="">
                                                <span class="content-editable">
                                                    {{ container.nw | number: '1.2-2' }}
                                                </span>
                                            </td>
                                            <td class="">
                                                <span class="content-editable">
                                                    {{ container.gw | number: '1.2-2' }}
                                                </span>
                                            </td>
                                            <td class="">
                                                <span class="content-editable">
                                                    {{ container.chargeAbleWeight | number: '1.2-2' }}
                                                </span>
                                            </td>
                                            <td class="">
                                                <span class="content-editable">
                                                    {{ container.unitOfMeasureName }}
                                                </span>
                                            </td>
                                            <td class="">
                                                <span class="content-editable">
                                                    {{ container.cbm | number: '1.2-2' }}
                                                </span>
                                            </td>
                                        </tr>
                                    </ng-container>
                                </tbody>
                            </table>
                        </div>
                        <!--end: Datatable -->
                    </div>
                </div>
                <div class="modal-footer m--align-center">
                    <button type="" class="btn btn-brand m-btn--square m-btn--icon m-btn--uppercase"
                        (click)="onSubmitContainer()">
                        <span>
                            <i class="la la-save"></i>
                            <span>
                                save
                            </span>
                        </span>
                    </button>
                    <button type="button" class="btn btn-cancel m-btn--square m-btn--icon m-btn--uppercase"
                        data-dismiss="modal">
                        <span>
                            <i class="la la-ban"></i>
                            <span>
                                cancel
                            </span>
                        </span>
                    </button>
                </div>
            </div>
        </form>
    </div>
</div>
<!--end::container-list-of-ops-billing-modal-->

<!--begin::confirm-accept-delete-container-modal-->
<div class="modal fade" id="confirm-accept-delete-container-modal" data-backdrop="static" role="dialog"
    aria-labelledby="" aria-hidden="true">
    <div class="modal-dialog modal-sm" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Delete Container</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="confirm-text-block">
                    <span>Are you sure you want to delete the selected container?</span>
                </div>
            </div>
            <div class="modal-footer m--align-center c-button-actions">
                <button type="button" class="btn btn-brand m-btn--square m-btn--icon m-btn--uppercase"
                    (click)=removeContainer()>
                    <span>
                        <i class="la la-save"></i>
                        <span>
                            Yes
                        </span>
                    </span>
                </button>
                <button type="reset" class="btn m-btn--square m-btn--icon m-btn--uppercase" data-dismiss="modal">
                    <span>
                        <i class="la la-ban"></i>
                        <span>
                            No
                        </span>
                    </span>
                </button>
            </div>
        </div>
    </div>
</div>
<!--end::confirm-accept-delete-container-modal-->

<!--begin:: add-buying-rate-modal-->
<form novalidate name="addBuyingRateChargeFormOps" #addBuyingRateChargeFormOps="ngForm"
    (ngSubmit)="addBuyingRateChargeFormOps.form.valid">
    <div class="modal fade" id="ops-add-buying-rate-modal" data-backdrop="static" role="dialog" aria-labelledby=""
        aria-hidden="true">

        <div class="modal-dialog c-modal-fullscreen" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Add buying charge</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"
                        (click)="closeChargeForm('ops-add-buying-rate-modal',addBuyingRateChargeFormOps)">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>

                <div class="modal-body" *ngIf="isDisplay">
                    <!--begin::Form-->
                    <div class="m-form m-form--state">
                        <div class="row">
                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': addBuyingRateChargeFormOps.submitted && BuyingRateChargeToAdd.chargeId==null}">
                                    <label class="form-control-label" for="" #selectedBuyingChargeCode>
                                        Charge <span class="m--font-danger">(*)</span>
                                        <small class="m--margin-left-5 m--font-primary"> &nbsp;
                                            {{selectedBuyingChargeCode.value==null?'':selectedBuyingChargeCode.value}}
                                        </small>
                                    </label>
                                    <app-combo-grid-virtual-scroll
                                        [currentActiveItemId]="{field:'charge.id',value:BuyingRateChargeToAdd.chargeId}"
                                        (itemSelected)="BuyingRateChargeToAdd.chargeId=$event.charge.id;
                                            BuyingRateChargeToAdd.unitId=$event.charge.unitId;
                                            BuyingRateChargeToAdd.unitPrice=$event.charge.unitPrice;
                                            BuyingRateChargeToAdd.vatrate=$event.charge.vatrate;
                                            selectedBuyingChargeCode.value=$event.charge.code;
                                            BuyingRateChargeToAdd.currencyId = $event.currency;
                                            currentActiveItemDefault=[{ id: $event.currency, text: $event.currency }];
                                            BuyingRateChargeToAdd.currencyId=$event.currency;
                                            calculateTotalEachBuying();"
                                        [selectedDisplayFields]="['charge.chargeNameEn']"
                                        [dataSources]="lstBuyingRateChargesComboBox"
                                        [displayFields]="[{'field':'charge.code','label':'Charge Code'},{'field':'charge.chargeNameEn','label':'Name EN'},{'field':'charge.chargeNameVn','label':'Name VN'}]">
                                    </app-combo-grid-virtual-scroll>

                                    <div class="form-control-feedback"
                                        *ngIf="addBuyingRateChargeFormOps.submitted && BuyingRateChargeToAdd.chargeId==null">
                                        Charge is required
                                    </div>
                                </div>
                            </div>


                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': addBuyingRateChargeFormOps.submitted && BuyingRateChargeToAdd.objectBePaid==null }">
                                    <label class="form-control-label" for="">
                                        Partner type <span class="m--font-danger">(*)</span>
                                    </label>
                                    <ng-select [allowClear]="true" [items]="[
                                                { 'text': 'AGENT', 'id': 'AGENT' },
                                                { 'text': 'SHIPPING LINE','id': 'SHIPPING' },
                                                { 'text': 'OTHER', 'id': 'OTHER' }]" [disabled]="disabled"
                                        (data)="refreshValue($event)"
                                        (selected)="BuyingRateChargeToAdd.objectBePaid=$event.id;
                                                    BuyingRateChargeToAdd.objectBePaid==='AGENT'? BuyingRateChargeToAdd.paymentObjectId=opsTransaction.agentId:null;
                                                    BuyingRateChargeToAdd.objectBePaid==='SHIPPING'? BuyingRateChargeToAdd.paymentObjectId=opsTransaction.supplierId:null;
                                                    BuyingRateChargeToAdd.objectBePaid==='OTHER'? BuyingRateChargeToAdd.paymentObjectId=null:null;"
                                        (removed)="BuyingRateChargeToAdd.objectBePaid=null;BuyingRateChargeToAdd.paymentObjectId=null;"
                                        (typed)="typed($event)" placeholder="Select filter">
                                    </ng-select>

                                    <div class="form-control-feedback"
                                        *ngIf="addBuyingRateChargeFormOps.submitted && BuyingRateChargeToAdd.objectBePaid==null">
                                        Partner type is required !
                                    </div>
                                </div>
                            </div>


                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': (addBuyingRateChargeFormOps.submitted && BuyingRateChargeToAdd.paymentObjectId==null)||(!addBuyingRateChargeFormOps.submitted && BuyingRateChargeToAdd.objectBePaid!==null && BuyingRateChargeToAdd.objectBePaid!=='OTHER' && BuyingRateChargeToAdd.paymentObjectId ===null)}">
                                    <label class="form-control-label" for="">
                                        <!-- <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': (addBuyingRateChargeFormOps.submitted && BuyingRateChargeToAdd.paymentObjectId==null)||(!addBuyingRateChargeFormOps.submitted && BuyingRateChargeToAdd.objectBePaid!==null && BuyingRateChargeToAdd.paymentObjectId==null)}">
                                    <label class="form-control-label" for=""> -->
                                        Partner name <span class="m--font-danger">(*)</span>
                                    </label>
                                    <app-combo-grid-virtual-scroll
                                        [disabled]="BuyingRateChargeToAdd.objectBePaid!=='OTHER'"
                                        [currentActiveItemId]="{field:'id',value:BuyingRateChargeToAdd.paymentObjectId}"
                                        (itemSelected)="BuyingRateChargeToAdd.paymentObjectId = $event.id"
                                        (remove)="BuyingRateChargeToAdd.paymentObjectId=null"
                                        [selectedDisplayFields]="['shortName']" [dataSources]="lstPartners"
                                        [displayFields]="[{'field':'id','label':'Partner ID'},{'field':'shortName','label':'Name ABBR'},{'field':'partnerNameEn','label':'Name EN'},{'field':'taxCode','label':'Tax Code'}]">
                                    </app-combo-grid-virtual-scroll>

                                    <div class="form-control-feedback"
                                        *ngIf="addBuyingRateChargeFormOps.submitted && BuyingRateChargeToAdd.paymentObjectId==null">
                                        Partner name is required !
                                    </div>

                                    <div class="form-control-feedback"
                                        *ngIf="(!addBuyingRateChargeFormOps.submitted && BuyingRateChargeToAdd.objectBePaid!==null && BuyingRateChargeToAdd.objectBePaid!=='OTHER' && BuyingRateChargeToAdd.paymentObjectId ===null)">
                                        Partner does not exist !
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': addBuyingRateChargeFormOps.submitted && (buyingRateChangeQuantityNameOps.invalid || BuyingRateChargeToAdd.quantity ==0)}">
                                    <label class="form-control-label" for="">
                                        Quantity <span class="m--font-danger">(*)</span>
                                    </label>
                                    <div class="input-group m-input-group m-input-group--square">
                                        <input type="number" required class="form-control m-input m-input--square"
                                            placeholder="Enter number" name="buyingRateChangeQuantityNameOps"
                                            decimalNumberGreaterThan0 #buyingRateChangeQuantityNameOps="ngModel"
                                            [(ngModel)]="BuyingRateChargeToAdd.quantity"
                                            (keyup)="calculateTotalEachBuying()">
                                        <!-- <div class="input-group-prepend">
                                            <button type="button" class="btn btn-secondary">
                                                CBM
                                            </button>
                                        </div> -->
                                    </div>
                                    <div class="form-control-feedback"
                                        *ngIf="addBuyingRateChargeFormOps.submitted && buyingRateChangeQuantityNameOps.invalid">
                                        Quantity is required !
                                    </div>
                                    <div class="form-control-feedback"
                                        *ngIf="addBuyingRateChargeFormOps.submitted && BuyingRateChargeToAdd.quantity ==0">
                                        Quantity must be greater than 0 !
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': addBuyingRateChargeFormOps.submitted && BuyingRateChargeToAdd.unitId==null}">
                                    <label class="form-control-label" for="">
                                        Unit <span class="m--font-danger">(*)</span>
                                    </label>

                                    <app-combo-grid-virtual-scroll
                                        [currentActiveItemId]="{field:'id',value:BuyingRateChargeToAdd.unitId}"
                                        (itemSelected)="BuyingRateChargeToAdd.unitId=$event.id"
                                        [selectedDisplayFields]="['unitNameEn']" [dataSources]="lstUnits"
                                        [displayFields]="[{'field':'unitNameEn','label':'Name EN'},{'field':'unitType','label':'Unit type'}]">
                                    </app-combo-grid-virtual-scroll>


                                    <div class="form-control-feedback"
                                        *ngIf="addBuyingRateChargeFormOps.submitted && BuyingRateChargeToAdd.unitId==null">
                                        Unit is required
                                    </div>


                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': addBuyingRateChargeFormOps.submitted &&(BuyingRateChargeUnitPriceNameOps.invalid || (0 >= BuyingRateChargeToAdd.unitPrice)) }">
                                    <label class="form-control-label" for="">
                                        Unit price <span class="m--font-danger">(*)</span>
                                    </label>
                                    <input type="text" class="form-control m-input m-input--square"
                                        [(ngModel)]="BuyingRateChargeToAdd.unitPrice"
                                        (keyup)="calculateTotalEachBuying()" placeholder="Enter number"
                                        #BuyingRateChargeUnitPriceNameOps="ngModel" required
                                        name="BuyingRateChargeUnitPriceNameOps">
                                    <div class="form-control-feedback"
                                        *ngIf="addBuyingRateChargeFormOps.submitted &&(BuyingRateChargeUnitPriceNameOps.invalid || (0 >= BuyingRateChargeToAdd.unitPrice))">
                                        Unit Price is required and must be larger than 0 !
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': addBuyingRateChargeFormOps.submitted && BuyingRateChargeToAdd.currencyId===null }">
                                    <label class="form-control-label" for="">
                                        Currency <span class="m--font-danger">(*)</span>
                                    </label>

                                    <ng-select [allowClear]="true" [items]="lstCurrencies" [disabled]="disabled"
                                        (data)="refreshValue($event)" [active]="currentActiveItemDefault"
                                        (selected)="BuyingRateChargeToAdd.currencyId=$event.id"
                                        (removed)="BuyingRateChargeToAdd.currencyId=null" placeholder="Select filter">
                                    </ng-select>

                                    <div class="form-control-feedback"
                                        *ngIf="addBuyingRateChargeFormOps.submitted && BuyingRateChargeToAdd.currencyId===null">
                                        Currency is required
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': addBuyingRateChargeFormOps.submitted && (BuyingRateChargeVATNameOps.invalid || BuyingRateChargeToAdd.vatrate >100) }">
                                    <label class="form-control-label" for="">
                                        VAT <span class="m--font-danger">(*)</span>
                                    </label>
                                    <input type="number" name="BuyingRateChargeVATNameOps" required
                                        #BuyingRateChargeVATNameOps="ngModel"
                                        [(ngModel)]="BuyingRateChargeToAdd.vatrate"
                                        class="form-control m-input m-input--square" placeholder="Enter number"
                                        (keyup)="calculateTotalEachBuying()">
                                    <div class="form-control-feedback"
                                        *ngIf="addBuyingRateChargeFormOps.submitted && (BuyingRateChargeVATNameOps.invalid || BuyingRateChargeToAdd.vatrate >100)">
                                        VAT is required and must be less than or equal 100
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="form-group">
                                    <label class="form-control-label" for="">
                                        Total
                                    </label>
                                    <input type="text" class="form-control m-input m-input--square" disabled
                                        name="BuyingRateChargeTotalNameOps" [(ngModel)]="BuyingRateChargeToAdd.total">
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-4">
                                <div class="form-group">
                                    <label class="form-control-label" for="">
                                        Doc no
                                    </label>
                                    <input type="text" [(ngModel)]="BuyingRateChargeToAdd.docNo"
                                        class="form-control m-input m-input--square" placeholder="Enter text"
                                        name="BuyingRateChargeDocNameOps">
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="form-group">
                                    <label class="form-control-label" for="">
                                        Note
                                    </label>
                                    <input type="text" [(ngModel)]="BuyingRateChargeToAdd.notes"
                                        class="form-control m-input m-input--square" placeholder="Enter text"
                                        name="BuyingRateChargeNoteNameOps">
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="form-group">
                                    <label class="form-control-label" for="">
                                        &nbsp;
                                    </label>
                                    <div>
                                        <label class="m-checkbox m-checkbox--bold">
                                            <input type="checkbox" name="BuyingRateChargeKickBackNameOps"
                                                [(ngModel)]="BuyingRateChargeToAdd.kickBack">
                                            Kick back
                                            <span></span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!--end::Form-->
                </div>
                <div class="modal-footer m--align-center">
                    <button class="btn btn-success m-btn--square m-btn--icon m-btn--uppercase" type="submit"
                        (click)="BuyingRateChargeToAdd.type='BUY';saveNewCharge('ops-add-buying-rate-modal',addBuyingRateChargeFormOps,BuyingRateChargeToAdd,true)">
                        <span>
                            <i class="la la-plus"></i>
                            <span>
                                save & continue
                            </span>
                        </span>
                    </button>
                    <button class="btn btn-brand m-btn--square m-btn--icon m-btn--uppercase" type="submit"
                        (click)="BuyingRateChargeToAdd.type='BUY';saveNewCharge('ops-add-buying-rate-modal',addBuyingRateChargeFormOps,BuyingRateChargeToAdd,false)">
                        <span>
                            <i class="la la-save"></i>
                            <span>
                                save
                            </span>
                        </span>
                    </button>
                    <button type="button" class="btn btn-cancel m-btn--square m-btn--icon m-btn--uppercase"
                        (click)="closeChargeForm('ops-add-buying-rate-modal',addBuyingRateChargeFormOps)">
                        <span>
                            <i class="la la-ban"></i>
                            <span>
                                cancel
                            </span>
                        </span>
                    </button>
                </div>
            </div>
        </div>

    </div>
</form>
<!--end:: add-buying-rate-modal-->

<!--begin:: edit-buying-rate-modal-->
<form novalidate #editBuyingRateChargeFormOps="ngForm" name="editBuyingRateChargeFormOps"
    *ngIf="BuyingRateChargeToEdit!==null" (ngSubmit)="editBuyingRateChargeFormOps.form.valid">
    <div class="modal fade" id="ops-edit-buying-rate-modal" data-backdrop="static" role="dialog" aria-labelledby=""
        aria-hidden="true">
        <div class="modal-dialog c-modal-fullscreen" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Edit buying rate</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"
                        (click)="closeChargeForm('ops-edit-buying-rate-modal',editBuyingRateChargeFormOps)">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body" *ngIf="isDisplay">
                    <!--begin::Form-->
                    <div class="m-form m-form--state">
                        <div class="row">
                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': editBuyingRateChargeFormOps.submitted && BuyingRateChargeToEdit.chargeId==null}">
                                    <label class="form-control-label" for="" #selectedBuyingChargeCode>
                                        Charge <span class="m--font-danger">(*)</span>
                                        <small class="m--margin-left-5 m--font-primary"> &nbsp;
                                            {{selectedBuyingChargeCode.value==null?'':selectedBuyingChargeCode.value}}
                                        </small>
                                    </label>

                                    <app-combo-grid-virtual-scroll
                                        [currentActiveItemId]="{field:'charge.id',value:BuyingRateChargeToEdit.chargeId}"
                                        (itemSelected)="BuyingRateChargeToEdit.chargeId=$event.charge.id;
                                        BuyingRateChargeToEdit.unitId=$event.charge.unitId;
                                        BuyingRateChargeToEdit.unitPrice=$event.charge.unitPrice;
                                        BuyingRateChargeToEdit.vatrate=$event.charge.vatrate;
                                            selectedBuyingChargeCode.value=$event.charge.code;
                                            calculateTotalEachBuying(true);"
                                        [selectedDisplayFields]="['charge.chargeNameEn']"
                                        [dataSources]="lstBuyingRateChargesComboBox"
                                        [displayFields]="[{'field':'charge.code','label':'Charge Code'},{'field':'charge.chargeNameEn','label':'Name EN'},{'field':'charge.chargeNameVn','label':'Name VN'}]">
                                    </app-combo-grid-virtual-scroll>

                                    <div class="form-control-feedback"
                                        *ngIf="editBuyingRateChargeFormOps.submitted && BuyingRateChargeToEdit.chargeId==null">
                                        Charge is required
                                    </div>
                                </div>
                            </div>


                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': editBuyingRateChargeFormOps.submitted && BuyingRateChargeToEdit.objectBePaid==null }">
                                    <label class="form-control-label" for="">
                                        Partner type <span class="m--font-danger">(*)</span>
                                    </label>
                                    <ng-select [allowClear]="true" [items]="[
                                                { 'text': 'AGENT', 'id': 'AGENT' },
                                                { 'text': 'SHIPPING LINE','id': 'SHIPPING' },
                                                { 'text': 'OTHER', 'id': 'OTHER' }]" [disabled]="disabled"
                                        [active]="[{'text':BuyingRateChargeToEdit.objectBePaid,'id':BuyingRateChargeToEdit.objectBePaid}]"
                                        (data)="refreshValue($event)" [disabled]="BuyingRateChargeToEdit.soano!=null"
                                        (selected)="BuyingRateChargeToEdit.objectBePaid=$event.id;
                                        BuyingRateChargeToEdit.objectBePaid==='AGENT'? BuyingRateChargeToEdit.paymentObjectId=opsTransaction.agentId:null;
                                        BuyingRateChargeToEdit.objectBePaid==='SHIPPING'? BuyingRateChargeToEdit.paymentObjectId=opsTransaction.supplierId:null;
                                        BuyingRateChargeToEdit.objectBePaid==='OTHER'? BuyingRateChargeToEdit.paymentObjectId=null:null;"
                                        (removed)="BuyingRateChargeToEdit.objectBePaid=null;BuyingRateChargeToEdit.paymentObjectId=null;"
                                        (typed)="typed($event)" placeholder="Select filter">
                                    </ng-select>

                                    <div class="form-control-feedback"
                                        *ngIf="editBuyingRateChargeFormOps.submitted && BuyingRateChargeToEdit.objectBePaid==null">
                                        Partner type is required !
                                    </div>
                                </div>
                            </div>


                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': editBuyingRateChargeFormOps.submitted && BuyingRateChargeToEdit.paymentObjectId==nulll }">
                                    <label class="form-control-label" for="">
                                        Partner name <span class="m--font-danger">(*)</span>
                                    </label>
                                    <app-combo-grid-virtual-scroll
                                        [disabled]="BuyingRateChargeToEdit.objectBePaid!=='OTHER' || BuyingRateChargeToEdit.soano!=null"
                                        [currentActiveItemId]="{field:'id',value:BuyingRateChargeToEdit.paymentObjectId}"
                                        (itemSelected)="BuyingRateChargeToEdit.paymentObjectId = $event.id"
                                        [selectedDisplayFields]="['shortName']" [dataSources]="lstPartners"
                                        [displayFields]="[{'field':'id','label':'Partner ID'},{'field':'shortName','label':'Name ABBR'},{'field':'partnerNameEn','label':'Name EN'},{'field':'taxCode','label':'Tax Code'}]">
                                    </app-combo-grid-virtual-scroll>

                                    <div class="form-control-feedback"
                                        *ngIf="editBuyingRateChargeFormOps.submitted && BuyingRateChargeToEdit.paymentObjectId==null">
                                        Partner name is required !
                                    </div>

                                    <div class="form-control-feedback"
                                        *ngIf="(!editBuyingRateChargeFormOps.submitted && BuyingRateChargeToAdd.objectBePaid!==null && BuyingRateChargeToAdd.objectBePaid!=='OTHER' && BuyingRateChargeToAdd.paymentObjectId ===null)">
                                        Partner does not exist !
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': editBuyingRateChargeFormOps.submitted && (buyingRateChangeQuantityNameOps.invalid || BuyingRateChargeToEdit.quantity == 0)}">
                                    <label class="form-control-label" for="">
                                        Quantity <span class="m--font-danger">(*)</span>
                                    </label>
                                    <div class="input-group m-input-group m-input-group--square">
                                        <input type="number" required class="form-control m-input m-input--square"
                                            decimalNumberGreaterThan0 placeholder="Enter number"
                                            [disabled]="BuyingRateChargeToEdit.soano!=null"
                                            name="buyingRateChangeQuantityNameOps"
                                            #buyingRateChangeQuantityNameOps="ngModel"
                                            [(ngModel)]="BuyingRateChargeToEdit.quantity"
                                            (keyup)="calculateTotalEachBuying(true)">
                                        <!-- <div class="input-group-prepend">
                                            <button type="button" class="btn btn-secondary">
                                                CBM
                                            </button>
                                        </div> -->
                                    </div>
                                    <div class="form-control-feedback"
                                        *ngIf="editBuyingRateChargeFormOps.submitted && buyingRateChangeQuantityNameOps.invalid">
                                        Quantity is required !
                                    </div>
                                    <div class="form-control-feedback"
                                        *ngIf="editBuyingRateChargeFormOps.submitted && BuyingRateChargeToEdit.quantity == 0">
                                        Quantity must be greater than 0 !
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': editBuyingRateChargeFormOps.submitted && BuyingRateChargeToEdit.unitId==null}">
                                    <label class="form-control-label" for="">
                                        Unit <span class="m--font-danger">(*)</span>
                                    </label>

                                    <app-combo-grid-virtual-scroll [disabled]="BuyingRateChargeToEdit.soano!=null"
                                        [currentActiveItemId]="{field:'id',value:BuyingRateChargeToEdit.unitId}"
                                        (itemSelected)="BuyingRateChargeToEdit.unitId=$event.id"
                                        [selectedDisplayFields]="['unitNameEn']" [dataSources]="lstUnits"
                                        [displayFields]="[{'field':'unitNameEn','label':'Name EN'},{'field':'unitType','label':'Unit type'}]">
                                    </app-combo-grid-virtual-scroll>

                                    <div class="form-control-feedback"
                                        *ngIf="editBuyingRateChargeFormOps.submitted && BuyingRateChargeToEdit.unitId==null">
                                        Unit is required
                                    </div>


                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': editBuyingRateChargeFormOps.submitted &&(BuyingRateChargeUnitPriceNameOps.invalid || (0 >= BuyingRateChargeToEdit.unitPrice)) }">
                                    <label class="form-control-label" for="">
                                        Unit price <span class="m--font-danger">(*)</span>
                                    </label>
                                    <input type="number" class="form-control m-input m-input--square"
                                        [disabled]="BuyingRateChargeToEdit.soano!=null"
                                        [(ngModel)]="BuyingRateChargeToEdit.unitPrice"
                                        (keyup)="calculateTotalEachBuying(true)" placeholder="Enter number"
                                        #BuyingRateChargeUnitPriceNameOps="ngModel" required
                                        name="BuyingRateChargeUnitPriceNameOps">
                                    <div class="form-control-feedback"
                                        *ngIf="editBuyingRateChargeFormOps.submitted &&(BuyingRateChargeUnitPriceNameOps.invalid || (0 >= BuyingRateChargeToEdit.unitPrice))">
                                        Unit Price is required and must be larger than 0 !
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': editBuyingRateChargeFormOps.submitted && BuyingRateChargeToEdit.currencyId===null }">
                                    <label class="form-control-label" for="">
                                        Currency <span class="m--font-danger">(*)</span>
                                    </label>

                                    <ng-select [allowClear]="true" [items]="lstCurrencies"
                                        [disabled]="BuyingRateChargeToEdit.soano!=null"
                                        [active]="[{'text':BuyingRateChargeToEdit.currency,'id':BuyingRateChargeToEdit.currencyId}]"
                                        (data)="refreshValue($event)"
                                        (selected)="BuyingRateChargeToEdit.currencyId=$event.id"
                                        (removed)="BuyingRateChargeToEdit.currencyId=null" placeholder="Select filter">
                                    </ng-select>

                                    <div class="form-control-feedback"
                                        *ngIf="editBuyingRateChargeFormOps.submitted && BuyingRateChargeToEdit.currencyId===null">
                                        Currency is required
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': editBuyingRateChargeFormOps.submitted && (BuyingRateChargeVATNameOps.invalid || BuyingRateChargeToEdit.vatrate > 100) }">
                                    <label class="form-control-label" for="">
                                        VAT <span class="m--font-danger">(*)</span>
                                    </label>
                                    <input type="number" max="100" name="BuyingRateChargeVATNameOps" required
                                        [disabled]="BuyingRateChargeToEdit.soano!=null"
                                        #BuyingRateChargeVATNameOps="ngModel"
                                        [(ngModel)]="BuyingRateChargeToEdit.vatrate"
                                        class="form-control m-input m-input--square" placeholder="Enter number"
                                        (keyup)="calculateTotalEachBuying(true)">
                                    <div class="form-control-feedback"
                                        *ngIf="editBuyingRateChargeFormOps.submitted && (BuyingRateChargeVATNameOps.invalid || BuyingRateChargeToEdit.vatrate > 100)">
                                        VAT is required and must be less than or equal 100
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="form-group">
                                    <label class="form-control-label" for="">
                                        Total
                                    </label>
                                    <input type="text" class="form-control m-input m-input--square" disabled
                                        name="BuyingRateChargeTotalNameOps" [(ngModel)]="BuyingRateChargeToEdit.total">
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-4">
                                <div class="form-group">
                                    <label class="form-control-label" for="">
                                        Doc no
                                    </label>
                                    <input type="text" [(ngModel)]="BuyingRateChargeToEdit.docNo"
                                        class="form-control m-input m-input--square" placeholder="Enter text"
                                        name="BuyingRateChargeDocNameOps">
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="form-group">
                                    <label class="form-control-label" for="">
                                        Note
                                    </label>
                                    <input type="text" [(ngModel)]="BuyingRateChargeToEdit.notes"
                                        [disabled]="BuyingRateChargeToEdit.soano!=null"
                                        class="form-control m-input m-input--square" placeholder="Enter text"
                                        name="BuyingRateChargeNoteNameOps">
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="form-group">
                                    <label class="form-control-label" for="">
                                        &nbsp;
                                    </label>
                                    <div>
                                        <label class="m-checkbox m-checkbox--bold">
                                            <input type="checkbox" name="BuyingRateChargeKickBackNameOps"
                                                [disabled]="BuyingRateChargeToEdit.soano!=null"
                                                [(ngModel)]="BuyingRateChargeToEdit.kickBack">
                                            Kick back
                                            <span></span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!--end::Form-->
                </div>
                <div class="modal-footer m--align-center">
                    <button type="submit" class="btn btn-brand m-btn--square m-btn--icon m-btn--uppercase" (click)="BuyingRateChargeToEdit.exchangeDate=(BuyingRateChargeToEdit.exchangeDate)==null?null:BuyingRateChargeToEdit.exchangeDate.startDate;
                        editCharge('ops-edit-buying-rate-modal',editBuyingRateChargeFormOps,BuyingRateChargeToEdit)">
                        <span>
                            <i class="la la-save"></i>
                            <span>
                                Save
                            </span>
                        </span>
                    </button>
                    <button type="button"
                        (click)="closeChargeForm('ops-edit-buying-rate-modal',editBuyingRateChargeFormOps)"
                        class="btn btn-cancel m-btn--square m-btn--icon m-btn--uppercase">
                        <span>
                            <i class="la la-ban"></i>
                            <span>
                                cancel
                            </span>
                        </span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</form>
<!--end:: Edit-buying-rate-modal-->

<!--begin:: ops-add-selling-rate-modal-->
<form novalidate name="addSellingRateChargeFormOps" #addSellingRateChargeFormOps="ngForm"
    (ngSubmit)="addSellingRateChargeFormOps.form.valid">
    <div class="modal fade" id="ops-add-selling-rate-modal" data-backdrop="static" role="dialog" aria-labelledby=""
        aria-hidden="true">
        <div class="modal-dialog c-modal-fullscreen" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Add selling charge</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"
                        (click)="closeChargeForm('ops-add-selling-rate-modal',addSellingRateChargeFormOps)">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body" *ngIf="isDisplay">
                    <!--begin::Form-->
                    <div class="m-form m-form--state">
                        <div class="row">
                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': addSellingRateChargeFormOps.submitted && SellingRateChargeToAdd.chargeId==null}">
                                    <label class="form-control-label" for="" #selectedSellingChargeCode>
                                        Charge <span class="m--font-danger">(*)</span>
                                        <small class="m--margin-left-5 m--font-primary"> &nbsp;
                                            {{selectedSellingChargeCode.value==null?'':selectedSellingChargeCode.value}}
                                        </small>
                                    </label>

                                    <app-combo-grid-virtual-scroll
                                        [currentActiveItemId]="{field:'charge.id',value:SellingRateChargeToAdd.chargeId}"
                                        (itemSelected)="SellingRateChargeToAdd.chargeId=$event.charge.id;
                                        SellingRateChargeToAdd.unitId=$event.charge.unitId;
                                        SellingRateChargeToAdd.unitPrice=$event.charge.unitPrice;
                                        SellingRateChargeToAdd.vatrate=$event.charge.vatrate;
                                        selectedSellingChargeCode.value=$event.charge.code;
                                        SellingRateChargeToAdd.currencyId=$event.currency;
                                        currentActiveItemDefault=[{ id: $event.currency, text: $event.currency }];
                                        calculateTotalEachSelling ();"
                                        [selectedDisplayFields]="['charge.chargeNameEn']"
                                        [dataSources]="lstSellingRateChargesComboBox"
                                        [displayFields]="[{'field':'charge.code','label':'Charge Code'},{'field':'charge.chargeNameEn','label':'Name EN'},{'field':'charge.chargeNameVn','label':'Name VN'}]">
                                    </app-combo-grid-virtual-scroll>

                                    <div class="form-control-feedback"
                                        *ngIf="addSellingRateChargeFormOps.submitted && SellingRateChargeToAdd.chargeId==null">
                                        Charge is required
                                    </div>


                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': addSellingRateChargeFormOps.submitted && SellingRateChargeToAdd.objectBePaid==null }">
                                    <label class="form-control-label" for="">
                                        Partner type <span class="m--font-danger">(*)</span>
                                    </label>
                                    <ng-select [allowClear]="true" [items]="[
                                                { 'text': 'AGENT', 'id': 'AGENT' },
                                                { 'text': 'CUSTOMER','id': 'CUSTOMER' },
                                                { 'text': 'OTHER', 'id': 'OTHER' }]" [disabled]="disabled"
                                        (data)="refreshValue($event)"
                                        (selected)="SellingRateChargeToAdd.objectBePaid=$event.id;
                                        SellingRateChargeToAdd.objectBePaid==='AGENT'? SellingRateChargeToAdd.paymentObjectId=opsTransaction.agentId:null;
                                        SellingRateChargeToAdd.objectBePaid==='CUSTOMER'? SellingRateChargeToAdd.paymentObjectId=opsTransaction.supplierId:null;
                                        SellingRateChargeToAdd.objectBePaid==='OTHER'? SellingRateChargeToAdd.paymentObjectId=null:null;"
                                        (removed)="SellingRateChargeToAdd.objectBePaid=null;SellingRateChargeToAdd.paymentObjectId=null;"
                                        (typed)="typed($event)" placeholder="Select filter">
                                    </ng-select>

                                    <div class="form-control-feedback"
                                        *ngIf="addSellingRateChargeFormOps.submitted && SellingRateChargeToAdd.objectBePaid==null">
                                        Partner type is required !
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': (addSellingRateChargeFormOps.submitted && SellingRateChargeToAdd.paymentObjectId==null)||(!addSellingRateChargeFormOps.submitted && SellingRateChargeToAdd.objectBePaid!==null && SellingRateChargeToAdd.paymentObjectId==null && SellingRateChargeToAdd.objectBePaid!=='OTHER')}">
                                    <label class="form-control-label" for="">
                                        Partner name <span class="m--font-danger">(*)</span>
                                    </label>
                                    <app-combo-grid-virtual-scroll
                                        [disabled]="SellingRateChargeToAdd.objectBePaid!=='OTHER'"
                                        [currentActiveItemId]="{field:'id',value:SellingRateChargeToAdd.paymentObjectId}"
                                        (itemSelected)="SellingRateChargeToAdd.paymentObjectId = $event.id"
                                        (remove)="SellingRateChargeToAdd.paymentObjectId=null"
                                        [selectedDisplayFields]="['shortName']" [dataSources]="lstPartners"
                                        [displayFields]="[{'field':'id','label':'Partner ID'},{'field':'shortName','label':'Name ABBR'},{'field':'partnerNameEn','label':'Name EN'},{'field':'taxCode','label':'Tax Code'}]">
                                    </app-combo-grid-virtual-scroll>

                                    <div class="form-control-feedback"
                                        *ngIf="addSellingRateChargeFormOps.submitted && SellingRateChargeToAdd.paymentObjectId==null">
                                        Partner name is required !
                                    </div>

                                    <div class="form-control-feedback"
                                        *ngIf="(!addSellingRateChargeFormOps.submitted && SellingRateChargeToAdd.objectBePaid!==null && SellingRateChargeToAdd.paymentObjectId===null && SellingRateChargeToAdd.objectBePaid!=='OTHER')">
                                        Partner does not exist !
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': addSellingRateChargeFormOps.submitted && (sellingRateChangeQuantityNameOps.invalid || SellingRateChargeToAdd.quantity == 0)}">
                                    <label class="form-control-label" for="">
                                        Quantity <span class="m--font-danger">(*)</span>
                                    </label>
                                    <div class="input-group m-input-group m-input-group--square">
                                        <input type="number" required class="form-control m-input m-input--square"
                                            decimalNumberGreaterThan0 placeholder="Enter number"
                                            name="sellingRateChangeQuantityNameOps"
                                            #sellingRateChangeQuantityNameOps="ngModel"
                                            [(ngModel)]="SellingRateChargeToAdd.quantity"
                                            (keyup)="calculateTotalEachSelling()">
                                        <!-- <div class="input-group-prepend">
                                            <button type="button" class="btn btn-secondary">
                                                CBM
                                            </button>
                                        </div> -->
                                    </div>
                                    <div class="form-control-feedback"
                                        *ngIf="addSellingRateChargeFormOps.submitted && sellingRateChangeQuantityNameOps.invalid">
                                        Quantity is required !
                                    </div>
                                    <div class="form-control-feedback"
                                        *ngIf="addSellingRateChargeFormOps.submitted && SellingRateChargeToAdd.quantity == 0">
                                        Quantity must be greater than 0 !
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': addSellingRateChargeFormOps.submitted && SellingRateChargeToAdd.unitId==null}">
                                    <label class="form-control-label" for="">
                                        Unit <span class="m--font-danger">(*)</span>
                                    </label>

                                    <app-combo-grid-virtual-scroll
                                        [currentActiveItemId]="{field:'id',value:SellingRateChargeToAdd.unitId}"
                                        (itemSelected)="SellingRateChargeToAdd.unitId=$event.id"
                                        [selectedDisplayFields]="['unitNameEn']" [dataSources]="lstUnits"
                                        [displayFields]="[{'field':'unitNameEn','label':'Name EN'},{'field':'unitType','label':'Unit type'}]">
                                    </app-combo-grid-virtual-scroll>


                                    <div class="form-control-feedback"
                                        *ngIf="addSellingRateChargeFormOps.submitted && SellingRateChargeToAdd.unitId==null">
                                        Unit is required
                                    </div>


                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': addSellingRateChargeFormOps.submitted &&(SellingRateChargeUnitPriceNameOps.invalid || (0 >= SellingRateChargeToAdd.unitPrice)) }">
                                    <label class="form-control-label" for="">
                                        Unit price <span class="m--font-danger">(*)</span>
                                    </label>
                                    <input type="number" class="form-control m-input m-input--square"
                                        [(ngModel)]="SellingRateChargeToAdd.unitPrice"
                                        (keyup)="calculateTotalEachSelling()" placeholder="Enter number"
                                        #SellingRateChargeUnitPriceNameOps="ngModel" required
                                        name="SellingRateChargeUnitPriceNameOps">
                                    <div class="form-control-feedback"
                                        *ngIf="addSellingRateChargeFormOps.submitted &&(SellingRateChargeUnitPriceNameOps.invalid || (0 >= SellingRateChargeToAdd.unitPrice))">
                                        Unit Price is required and must be larger than 0 !
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': addSellingRateChargeFormOps.submitted && SellingRateChargeToAdd.currencyId===null }">
                                    <label class="form-control-label" for="">
                                        Currency <span class="m--font-danger">(*)</span>
                                    </label>

                                    <ng-select [allowClear]="true" [items]="lstCurrencies" [disabled]="disabled"
                                        (data)="refreshValue($event)" [active]="currentActiveItemDefault"
                                        (selected)="SellingRateChargeToAdd.currencyId=$event.id"
                                        (removed)="SellingRateChargeToAdd.currencyId=null" placeholder="Select filter">
                                    </ng-select>

                                    <div class="form-control-feedback"
                                        *ngIf="addSellingRateChargeFormOps.submitted && SellingRateChargeToAdd.currencyId===null">
                                        Currency is required
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': addSellingRateChargeFormOps.submitted && (SellingRateChargeVATNameOps.invalid || SellingRateChargeToAdd.vatrate > 100) }">
                                    <label class="form-control-label" for="">
                                        VAT <span class="m--font-danger">(*)</span>
                                    </label>
                                    <input type="number" name="SellingRateChargeVATNameOps" required
                                        #SellingRateChargeVATNameOps="ngModel"
                                        [(ngModel)]="SellingRateChargeToAdd.vatrate"
                                        class="form-control m-input m-input--square" placeholder="Enter number"
                                        (keyup)="calculateTotalEachSelling()">
                                    <div class="form-control-feedback"
                                        *ngIf="addSellingRateChargeFormOps.submitted && (SellingRateChargeVATNameOps.invalid || SellingRateChargeToAdd.vatrate > 100)">
                                        VAT is required and must be less than or equal 100
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="form-group">
                                    <label class="form-control-label" for="">
                                        Total
                                    </label>
                                    <input type="text" class="form-control m-input m-input--square" disabled
                                        name="SellingRateChargeTotalNameOps" [(ngModel)]="SellingRateChargeToAdd.total">
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-4">
                                <div class="form-group">
                                    <label class="form-control-label" for="">
                                        Doc no
                                    </label>
                                    <input type="text" [(ngModel)]="SellingRateChargeToAdd.docNo"
                                        class="form-control m-input m-input--square" placeholder="Enter text"
                                        name="SellingRateChargeDocNameOps">
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="form-group">
                                    <label class="form-control-label" for="">
                                        Note
                                    </label>
                                    <input type="text" [(ngModel)]="SellingRateChargeToAdd.notes"
                                        class="form-control m-input m-input--square" placeholder="Enter text"
                                        name="SellingRateChargeNoteNameOps">
                                </div>
                            </div>
                        </div>
                    </div>
                    <!--end::Form-->
                </div>
                <div class="modal-footer m--align-center">
                    <button class="btn btn-success m-btn--square m-btn--icon m-btn--uppercase"
                        (click)="SellingRateChargeToAdd.type='SELL';saveNewCharge('ops-add-selling-rate-modal',addSellingRateChargeFormOps,SellingRateChargeToAdd,true)">
                        <span>
                            <i class="la la-plus"></i>
                            <span>
                                save & continue
                            </span>
                        </span>
                    </button>
                    <button class="btn btn-brand m-btn--square m-btn--icon m-btn--uppercase"
                        (click)="SellingRateChargeToAdd.type='SELL';saveNewCharge('ops-add-selling-rate-modal',addSellingRateChargeFormOps,SellingRateChargeToAdd,false)">
                        <span>
                            <i class="la la-save"></i>
                            <span>
                                save
                            </span>
                        </span>
                    </button>
                    <button type="button" class="btn btn-cancel m-btn--square m-btn--icon m-btn--uppercase"
                        (click)="closeChargeForm('ops-add-selling-rate-modal',addSellingRateChargeFormOps)">
                        <span>
                            <i class="la la-ban"></i>
                            <span>
                                cancel
                            </span>
                        </span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</form>
<!--end:: add-selling-rate-modal-->

<!--begin:: Edit-selling-rate-modal-->
<form novalidate #editSellingRateChargeFormOps="ngForm" name="editSellingRateChargeFormOps"
    *ngIf="SellingRateChargeToEdit!==null" (ngSubmit)="editSellingRateChargeFormOps.form.valid">
    <div class="modal fade" id="ops-edit-selling-rate-modal" data-backdrop="static" role="dialog" aria-labelledby=""
        aria-hidden="true">
        <div class="modal-dialog c-modal-fullscreen" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Edit selling rate</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"
                        (click)="closeChargeForm('ops-edit-selling-rate-modal',editSellingRateChargeFormOps)">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body" *ngIf="isDisplay">
                    <!--begin::Form-->
                    <div class="m-form m-form--state">
                        <div class="row">
                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': editSellingRateChargeFormOps.submitted && SellingRateChargeToEdit.chargeId==null}">
                                    <label class="form-control-label" for="" #selectedBuyingChargeCode>
                                        Charge <span class="m--font-danger">(*)</span>
                                        <small class="m--margin-left-5 m--font-primary"> &nbsp;
                                            {{selectedBuyingChargeCode.value==null?'':selectedBuyingChargeCode.value}}
                                        </small>
                                    </label>

                                    <app-combo-grid-virtual-scroll
                                        [currentActiveItemId]="{field:'charge.id',value:SellingRateChargeToEdit.chargeId}"
                                        (itemSelected)="SellingRateChargeToEdit.chargeId=$event.charge.id;
                                        SellingRateChargeToEdit.unitId=$event.charge.unitId;
                                        SellingRateChargeToEdit.unitPrice=$event.charge.unitPrice;
                                        SellingRateChargeToEdit.vatrate=$event.charge.vatrate;
                                            selectedBuyingChargeCode.value=$event.charge.code;
                                            calculateTotalEachSelling(true);"
                                        [selectedDisplayFields]="['charge.chargeNameEn']"
                                        [dataSources]="lstSellingRateChargesComboBox"
                                        [displayFields]="[{'field':'charge.code','label':'Charge Code'},{'field':'charge.chargeNameEn','label':'Name EN'},{'field':'charge.chargeNameVn','label':'Name VN'}]">
                                    </app-combo-grid-virtual-scroll>

                                    <div class="form-control-feedback"
                                        *ngIf="editSellingRateChargeFormOps.submitted && SellingRateChargeToEdit.chargeId==null">
                                        Charge is required
                                    </div>
                                </div>
                            </div>


                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': editSellingRateChargeFormOps.submitted && SellingRateChargeToEdit.objectBePaid==null }">
                                    <label class="form-control-label" for="">
                                        Partner type <span class="m--font-danger">(*)</span>
                                    </label>
                                    <ng-select [allowClear]="true" [items]="[
                                                { 'text': 'AGENT', 'id': 'AGENT' },
                                                { 'text': 'CUSTOMER','id': 'CUSTOMER' },
                                                { 'text': 'OTHER', 'id': 'OTHER' }]" [disabled]="disabled"
                                        [active]="[{'text':SellingRateChargeToEdit.objectBePaid,'id':SellingRateChargeToEdit.objectBePaid}]"
                                        (data)="refreshValue($event)" [disabled]="SellingRateChargeToEdit.soano!=null"
                                        (selected)="SellingRateChargeToEdit.objectBePaid=$event.id;
                                        SellingRateChargeToEdit.objectBePaid==='AGENT'? SellingRateChargeToEdit.paymentObjectId=opsTransaction.agentId:null;
                                        SellingRateChargeToEdit.objectBePaid==='CUSTOMER'? SellingRateChargeToEdit.paymentObjectId=opsTransaction.supplierId:null;
                                        SellingRateChargeToEdit.objectBePaid==='OTHER'? SellingRateChargeToEdit.paymentObjectId=null:null;"
                                        (removed)="SellingRateChargeToEdit.objectBePaid=null;SellingRateChargeToEdit.paymentObjectId=null;"
                                        (typed)="typed($event)" placeholder="Select filter">
                                    </ng-select>

                                    <div class="form-control-feedback"
                                        *ngIf="editSellingRateChargeFormOps.submitted && SellingRateChargeToEdit.objectBePaid==null">
                                        Partner type is required !
                                    </div>
                                </div>
                            </div>


                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': (editSellingRateChargeFormOps.submitted && SellingRateChargeToEdit.paymentObjectId==nulll)||(!addSellingRateChargeFormOps.submitted && SellingRateChargeToAdd.objectBePaid!==null && SellingRateChargeToAdd.paymentObjectId==null && SellingRateChargeToAdd.objectBePaid!=='OTHER')}">
                                    <label class="form-control-label" for="">
                                        Partner name <span class="m--font-danger">(*)</span>
                                    </label>
                                    <app-combo-grid-virtual-scroll
                                        [disabled]="SellingRateChargeToEdit.objectBePaid!=='OTHER' || SellingRateChargeToEdit.soano!=null"
                                        [currentActiveItemId]="{field:'id',value:SellingRateChargeToEdit.paymentObjectId}"
                                        (itemSelected)="SellingRateChargeToEdit.paymentObjectId = $event.id"
                                        [selectedDisplayFields]="['shortName']" [dataSources]="lstPartners"
                                        [displayFields]="[{'field':'id','label':'Partner ID'},{'field':'shortName','label':'Name ABBR'},{'field':'partnerNameEn','label':'Name EN'},{'field':'taxCode','label':'Tax Code'}]">
                                    </app-combo-grid-virtual-scroll>

                                    <div class="form-control-feedback"
                                        *ngIf="editSellingRateChargeFormOps.submitted && SellingRateChargeToEdit.paymentObjectId==null">
                                        Partner name is required !
                                    </div>

                                    <div class="form-control-feedback"
                                        *ngIf="(!editSellingRateChargeFormOps.submitted && SellingRateChargeToEdit.objectBePaid!==null && SellingRateChargeToEdit.paymentObjectId==null && SellingRateChargeToEdit.objectBePaid!=='OTHER')">
                                        Partner does not exist !
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': editSellingRateChargeFormOps.submitted && (sellingRateChangeQuantityNameOps.invalid || SellingRateChargeToEdit.quantity == 0)}">
                                    <label class="form-control-label" for="">
                                        Quantity <span class="m--font-danger">(*)</span>
                                    </label>
                                    <div class="input-group m-input-group m-input-group--square">
                                        <input type="number" required class="form-control m-input m-input--square"
                                            decimalNumberGreaterThan0 placeholder="Enter number"
                                            [disabled]="SellingRateChargeToEdit.soano!=null"
                                            name="sellingRateChangeQuantityNameOps"
                                            #sellingRateChangeQuantityNameOps="ngModel"
                                            [(ngModel)]="SellingRateChargeToEdit.quantity"
                                            (keyup)="calculateTotalEachSelling(true)">
                                        <!-- <div class="input-group-prepend">
                                            <button type="button" class="btn btn-secondary">
                                                CBM
                                            </button>
                                        </div> -->
                                    </div>
                                    <div class="form-control-feedback"
                                        *ngIf="editSellingRateChargeFormOps.submitted && sellingRateChangeQuantityNameOps.invalid">
                                        Quantity is required !
                                    </div>
                                    <div class="form-control-feedback"
                                        *ngIf="editSellingRateChargeFormOps.submitted && SellingRateChargeToEdit.quantity == 0">
                                        Quantity must be greater than 0 !
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': editSellingRateChargeFormOps.submitted && SellingRateChargeToEdit.unitId==null}">
                                    <label class="form-control-label" for="">
                                        Unit <span class="m--font-danger">(*)</span>
                                    </label>

                                    <app-combo-grid-virtual-scroll [disabled]="SellingRateChargeToEdit.soano!=null"
                                        [currentActiveItemId]="{field:'id',value:SellingRateChargeToEdit.unitId}"
                                        (itemSelected)="SellingRateChargeToEdit.unitId=$event.id"
                                        [selectedDisplayFields]="['unitNameEn']" [dataSources]="lstUnits"
                                        [displayFields]="[{'field':'unitNameEn','label':'Name EN'},{'field':'unitType','label':'Unit type'}]">
                                    </app-combo-grid-virtual-scroll>

                                    <div class="form-control-feedback"
                                        *ngIf="editSellingRateChargeFormOps.submitted && SellingRateChargeToEdit.unitId==null">
                                        Unit is required
                                    </div>


                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': editSellingRateChargeFormOps.submitted &&(SellingRateChargeUnitPriceNameOps.invalid || (0 >= SellingRateChargeToEdit.unitPrice)) }">
                                    <label class="form-control-label" for="">
                                        Unit price <span class="m--font-danger">(*)</span>
                                    </label>
                                    <input type="number" class="form-control m-input m-input--square"
                                        [disabled]="SellingRateChargeToEdit.soano!=null"
                                        [(ngModel)]="SellingRateChargeToEdit.unitPrice"
                                        (keyup)="calculateTotalEachSelling(true)" placeholder="Enter number"
                                        #SellingRateChargeUnitPriceNameOps="ngModel" required
                                        name="SellingRateChargeUnitPriceNameOps">
                                    <div class="form-control-feedback"
                                        *ngIf="editSellingRateChargeFormOps.submitted &&(SellingRateChargeUnitPriceNameOps.invalid || (0 >= SellingRateChargeToEdit.unitPrice))">
                                        Unit Price is required and must be larger than 0 !
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': editSellingRateChargeFormOps.submitted && SellingRateChargeToEdit.currencyId===null }">
                                    <label class="form-control-label" for="">
                                        Currency <span class="m--font-danger">(*)</span>
                                    </label>

                                    <ng-select [allowClear]="true" [items]="lstCurrencies"
                                        [disabled]="SellingRateChargeToEdit.soano!=null"
                                        [active]="[{'text':SellingRateChargeToEdit.currency,'id':SellingRateChargeToEdit.currencyId}]"
                                        (data)="refreshValue($event)"
                                        (selected)="SellingRateChargeToEdit.currencyId=$event.id"
                                        (removed)="SellingRateChargeToEdit.currencyId=null" placeholder="Select filter">
                                    </ng-select>

                                    <div class="form-control-feedback"
                                        *ngIf="editSellingRateChargeFormOps.submitted && SellingRateChargeToEdit.currencyId===null">
                                        Currency is required
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': editSellingRateChargeFormOps.submitted && (SellingRateChargeVATNameOps.invalid || SellingRateChargeToEdit.vatrate > 100) }">
                                    <label class="form-control-label" for="">
                                        VAT <span class="m--font-danger">(*)</span>
                                    </label>
                                    <input type="number" max="100" name="SellingRateChargeVATNameOps" required
                                        [disabled]="SellingRateChargeToEdit.soano!=null"
                                        #SellingRateChargeVATNameOps="ngModel"
                                        [(ngModel)]="SellingRateChargeToEdit.vatrate"
                                        class="form-control m-input m-input--square" placeholder="Enter number"
                                        (keyup)="calculateTotalEachSelling(true)">
                                    <div class="form-control-feedback"
                                        *ngIf="editSellingRateChargeFormOps.submitted && (SellingRateChargeVATNameOps.invalid || SellingRateChargeToEdit.vatrate > 100)">
                                        VAT is required and must be less than or equal 100
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="form-group">
                                    <label class="form-control-label" for="">
                                        Total
                                    </label>
                                    <input type="text" class="form-control m-input m-input--square" disabled
                                        name="SellingRateChargeTotalNameOps"
                                        [(ngModel)]="SellingRateChargeToEdit.total">
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-4">
                                <div class="form-group">
                                    <label class="form-control-label" for="">
                                        Doc no
                                    </label>
                                    <input type="text" [(ngModel)]="SellingRateChargeToEdit.docNo"
                                        class="form-control m-input m-input--square" placeholder="Enter text"
                                        name="SellingRateChargeDocNameOps">
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="form-group">
                                    <label class="form-control-label" for="">
                                        Note
                                    </label>
                                    <input type="text" [(ngModel)]="SellingRateChargeToEdit.notes"
                                        [disabled]="SellingRateChargeToEdit.soano!=null"
                                        class="form-control m-input m-input--square" placeholder="Enter text"
                                        name="SellingRateChargeNoteNameOps">
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="form-group">
                                    <label class="form-control-label" for="">
                                        Exchange rate date
                                    </label>
                                    <div class="m-input-icon m-input-icon--right down">
                                        <input type="text" class="form-control m-input m-input--square"
                                            ngxDaterangepickerMd [autoApply]="true"
                                            [locale]="{applyLabel: 'ok', format: 'DD/MM/YYYY'}"
                                            [(ngModel)]="exchangeRateDate" [singleDatePicker]="true"
                                            name="exchangeRateDate" readonly />
                                        <span class="m-input-icon__icon m-input-icon__icon--right">
                                            <span>
                                                <i class="la la-calendar"></i>
                                            </span>
                                        </span>
                                    </div>
                                    <div class="form-control-feedback"
                                        *ngIf="editSellingRateChargeFormOps.submitted && this.exchangeRateDate.startDate != null && this.exchangeRateDate.startDate != null && (this.exchangeRateDate.startDate < this.exchangeRateDate.startDate)">
                                        Finish Date must more greater or equal Service Date
                                    </div>
                                </div>
                            </div>
                            <!-- <div class="col-lg-4">
                                <div class="form-group">
                                    <label class="form-control-label" for="">
                                        &nbsp;
                                    </label>
                                    <div>
                                        <label class="m-checkbox m-checkbox--bold">
                                            <input type="checkbox" name="SellingRateChargeKickBackNameOps"
                                                [disabled]="SellingRateChargeToEdit.soano!=null"
                                                [(ngModel)]="SellingRateChargeToEdit.kickBack">
                                            Kick back
                                            <span></span>
                                        </label>
                                    </div>
                                </div>
                            </div> -->
                        </div>
                    </div>
                    <!--end::Form-->
                </div>
                <div class="modal-footer m--align-center">
                    <button class="btn btn-brand m-btn--square m-btn--icon m-btn--uppercase" (click)="SellingRateChargeToEdit.exchangeDate=(SellingRateChargeToEdit.exchangeDate)==null?null:SellingRateChargeToEdit.exchangeDate.startDate;
                    editCharge('ops-edit-selling-rate-modal',editSellingRateChargeFormOps,SellingRateChargeToEdit)">
                        <span>
                            <i class="la la-save"></i>
                            <span>
                                Save
                            </span>
                        </span>
                    </button>
                    <button type="button" class="btn btn-cancel m-btn--square m-btn--icon m-btn--uppercase"
                        (click)="closeChargeForm('ops-edit-selling-rate-modal',editSellingRateChargeFormOps)">
                        <span>
                            <i class="la la-ban"></i>
                            <span>
                                cancel
                            </span>
                        </span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</form>
<!--end:: Edit-selling-rate-modal-->

<!--begin:: add-obh-charge-modal-->
<form novalidate name="addOBHChargeFormOps" #addOBHChargeFormOps="ngForm" (ngSubmit)="addOBHChargeFormOps.form.valid">
    <div class="modal fade" id="ops-add-obh-charge-modal" data-backdrop="static" role="dialog" aria-labelledby=""
        aria-hidden="true">
        <div class="modal-dialog c-modal-fullscreen" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Add OBH charge</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"
                        (click)="closeChargeForm('ops-add-obh-charge-modal',addOBHChargeFormOps)">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body" *ngIf="isDisplay">
                    <!--begin::Form-->
                    <div class="m-form m-form--state">
                        <div class="row">
                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': addOBHChargeFormOps.submitted && OBHChargeToAdd.chargeId==null}">
                                    <label class="form-control-label" for="" #selectedOBHChargeCode>
                                        Charge <span class="m--font-danger">(*)</span> <small
                                            class="m--margin-left-5 m--font-primary">{{selectedOBHChargeCode.value==null?'':selectedOBHChargeCode.value}}&nbsp;</small>
                                    </label>

                                    <app-combo-grid-virtual-scroll
                                        [currentActiveItemId]="{field:'charge.id',value:OBHChargeToAdd.chargeId}"
                                        (itemSelected)="OBHChargeToAdd.chargeId=$event.charge.id;
                                                OBHChargeToAdd.unitId=$event.charge.unitId;
                                                OBHChargeToAdd.unitPrice=$event.charge.unitPrice;
                                                OBHChargeToAdd.vatrate = $event.charge.vatrate;
                                                selectedOBHChargeCode.value=$event.charge.code;
                                                OBHChargeToAdd.currencyId=$event.currency;
                                                currentActiveItemDefault=[{ id: $event.currency, text: $event.currency }];
                                                calculateTotalEachOBH()"
                                        [selectedDisplayFields]="['charge.chargeNameEn']"
                                        [dataSources]="lstOBHChargesComboBox"
                                        [displayFields]="[{'field':'charge.code','label':'Charge Code'},{'field':'charge.chargeNameEn','label':'Name EN'},{'field':'charge.chargeNameVn','label':'Name VN'}]">
                                    </app-combo-grid-virtual-scroll>

                                    <div class="form-control-feedback"
                                        *ngIf="addOBHChargeFormOps.submitted && OBHChargeToAdd.chargeId==null">
                                        Charge is required
                                    </div>

                                </div>
                            </div>

                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': addOBHChargeFormOps.submitted && (OBHChargeToAdd.receiverId==null || OBHChargeToAdd.receiverId==OBHChargeToAdd.payerId)}">
                                    <label class="form-control-label" for="">
                                        Receiver <span class="m--font-danger">(*)</span>
                                    </label>

                                    <app-combo-grid-virtual-scroll
                                        [currentActiveItemId]="{field:'id',value:OBHChargeToAdd.receiverId}"
                                        (itemSelected)="OBHChargeToAdd.receiverId = $event.id"
                                        [selectedDisplayFields]="['shortName']" [dataSources]="lstPartners"
                                        [displayFields]="[{'field':'id','label':'Partner ID'},{'field':'shortName','label':'Name ABBR'},{'field':'partnerNameEn','label':'Name EN'},{'field':'taxCode','label':'Tax Code'}]">
                                    </app-combo-grid-virtual-scroll>

                                    <div class="form-control-feedback"
                                        *ngIf="addOBHChargeFormOps.submitted && (OBHChargeToAdd.receiverId==null || OBHChargeToAdd.receiverId==OBHChargeToAdd.payerId)">
                                        Receiver name is required and do not same with payer!
                                    </div>


                                </div>
                            </div>


                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': addOBHChargeFormOps.submitted && (OBHChargeToAdd.payerId==null || OBHChargeToAdd.receiverId==OBHChargeToAdd.payerId)}">
                                    <label class="form-control-label" for="">
                                        Payer <span class="m--font-danger">(*)</span>
                                    </label>

                                    <app-combo-grid-virtual-scroll
                                        [currentActiveItemId]="{field:'id',value:OBHChargeToAdd.payerId}"
                                        (itemSelected)="OBHChargeToAdd.payerId  = $event.id"
                                        [selectedDisplayFields]="['shortName']" [dataSources]="lstPartners"
                                        [displayFields]="[{'field':'id','label':'Partner ID'},{'field':'shortName','label':'Name ABBR'},{'field':'partnerNameEn','label':'Name EN'},{'field':'taxCode','label':'Tax Code'}]">
                                    </app-combo-grid-virtual-scroll>

                                    <div class="form-control-feedback"
                                        *ngIf="addOBHChargeFormOps.submitted && (OBHChargeToAdd.payerId==null || OBHChargeToAdd.receiverId==OBHChargeToAdd.payerId)">
                                        Payer name is required and do not same with receiver!
                                    </div>

                                </div>
                            </div>

                        </div>
                        <div class="row">
                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': addOBHChargeFormOps.submitted && (OBHQuantityNameOps.invalid || OBHChargeToAdd.quantity == 0) }">
                                    <label class="form-control-label" for="">
                                        Quantity <span class="m--font-danger">(*)</span>
                                    </label>
                                    <input type="number" class="form-control m-input m-input--square"
                                        decimalNumberGreaterThan0 placeholder="Enter number"
                                        #OBHQuantityNameOps="ngModel" [(ngModel)]="OBHChargeToAdd.quantity" required
                                        (keyup)="calculateTotalEachOBH()" name="OBHQuantityNameOps">
                                    <div class="form-control-feedback"
                                        *ngIf="addOBHChargeFormOps.submitted && OBHQuantityNameOps.invalid">
                                        Quantity is required !
                                    </div>
                                    <div class="form-control-feedback"
                                        *ngIf="addOBHChargeFormOps.submitted && OBHChargeToAdd.quantity == 0">
                                        Quantity must be greater than 0 !
                                    </div>
                                </div>
                            </div>


                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': addOBHChargeFormOps.submitted && OBHChargeToAdd.unitId==null}">

                                    <label class="form-control-label" for="">
                                        Unit <span class="m--font-danger">(*)</span>
                                    </label>

                                    <app-combo-grid-virtual-scroll
                                        [currentActiveItemId]="{field:'id',value:OBHChargeToAdd.unitId}"
                                        (itemSelected)="OBHChargeToAdd.unitId=$event.id"
                                        [selectedDisplayFields]="['unitNameEn']" [dataSources]="lstUnits"
                                        [displayFields]="[{'field':'unitNameEn','label':'Name EN'},{'field':'unitType','label':'Unit type'}]">
                                    </app-combo-grid-virtual-scroll>

                                    <div class="form-control-feedback"
                                        *ngIf="addOBHChargeFormOps.submitted && OBHChargeToAdd.chargeId==null">
                                        Unit is required
                                    </div>

                                </div>
                            </div>


                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': addOBHChargeFormOps.submitted &&(OBHUnitPriceNameOps.invalid || (0 >= OBHChargeToAdd.unitPrice)) }">
                                    <label class="form-control-label" for="">
                                        Unit price <span class="m--font-danger">(*)</span>
                                    </label>
                                    <input type="number" class="form-control m-input m-input--square"
                                        [(ngModel)]="OBHChargeToAdd.unitPrice" placeholder="Enter number" required
                                        name="OBHUnitPriceNameOps" #OBHUnitPriceNameOps="ngModel"
                                        (keyup)="calculateTotalEachOBH()">
                                    <div class="form-control-feedback"
                                        *ngIf="addOBHChargeFormOps.submitted &&(OBHUnitPriceNameOps.invalid || (0 >= OBHChargeToAdd.unitPrice))">
                                        Unit Price is required and must be larger than 0 !
                                    </div>
                                </div>
                            </div>


                        </div>
                        <div class="row">
                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': addOBHChargeFormOps.submitted && OBHChargeToAdd.currencyId===null }">
                                    <label class="form-control-label" for="">
                                        Currency <span class="m--font-danger">(*)</span>
                                    </label>

                                    <ng-select [allowClear]="true" [items]="lstCurrencies" [disabled]="disabled"
                                        [active]="currentActiveItemDefault" (data)="refreshValue($event)"
                                        (selected)="OBHChargeToAdd.currencyId=$event.id"
                                        (removed)="OBHChargeToAdd.currencyId=null" placeholder="Select filter">
                                    </ng-select>

                                    <div class="form-control-feedback"
                                        *ngIf="addOBHChargeFormOps.submitted && OBHChargeToAdd.currencyId===null">
                                        Currency is required
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': addOBHChargeFormOps.submitted && (OBHRateChargeVATNameOps.invalid || OBHChargeToAdd.vatrate > 100) }">
                                    <label class="form-control-label" for="">
                                        VAT <span class="m--font-danger">(*)</span>
                                    </label>
                                    <input type="number" max="100" name="OBHRateChargeVATNameOps" required
                                        #OBHRateChargeVATNameOps="ngModel" [(ngModel)]="OBHChargeToAdd.vatrate"
                                        class="form-control m-input m-input--square" placeholder="Enter number"
                                        (keyup)="calculateTotalEachOBH()">
                                    <div class="form-control-feedback"
                                        *ngIf="addOBHChargeFormOps.submitted && (OBHRateChargeVATNameOps.invalid || OBHChargeToAdd.vatrate > 100)">
                                        VAT is required and must be less than or equal 100
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="form-group">
                                    <label class="form-control-label" for="">
                                        Total
                                    </label>
                                    <input type="text" class="form-control m-input m-input--square" disabled
                                        name="OBHChargeTotalNameOps" [(ngModel)]="OBHChargeToAdd.total">
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-4">
                                <div class="form-group">
                                    <label class="form-control-label" for="">
                                        Doc no
                                    </label>
                                    <input type="text" [(ngModel)]="OBHChargeToAdd.docNo"
                                        class="form-control m-input m-input--square" placeholder="Enter text"
                                        name="OBHChargeDocNameOps">
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="form-group">
                                    <label class="form-control-label" for="">
                                        Note
                                    </label>
                                    <input type="text" [(ngModel)]="OBHChargeToAdd.notes"
                                        class="form-control m-input m-input--square" placeholder="Enter text"
                                        name="OBHChargeNoteNameOps">
                                </div>
                            </div>
                        </div>
                    </div>
                    <!--end::Form-->
                </div>
                <div class="modal-footer m--align-center">
                    <button class="btn btn-success m-btn--square m-btn--icon m-btn--uppercase"
                        (click)="OBHChargeToAdd.type='OBH';saveNewCharge('ops-add-obh-charge-modal',addOBHChargeFormOps,OBHChargeToAdd,true)">
                        <span>
                            <i class="la la-plus"></i>
                            <span>
                                save & continue
                            </span>
                        </span>
                    </button>
                    <button class="btn btn-brand m-btn--square m-btn--icon m-btn--uppercase"
                        (click)="OBHChargeToAdd.type='OBH';saveNewCharge('ops-add-obh-charge-modal',addOBHChargeFormOps,OBHChargeToAdd,false)">
                        <span>
                            <i class="la la-save"></i>
                            <span>
                                save
                            </span>
                        </span>
                    </button>
                    <button type="button" class="btn btn-cancel m-btn--square m-btn--icon m-btn--uppercase"
                        (click)="closeChargeForm('ops-add-obh-charge-modal',addOBHChargeFormOps)">
                        <span>
                            <i class="la la-ban"></i>
                            <span>
                                cancel
                            </span>
                        </span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</form>
<!--end:: add-obh-charge-modal-->

<!--begin:: edit-obh-charge-modal-->
<form novalidate #editOBHChargeFormOps="ngForm" name="editOBHChargeFormOps" *ngIf="OBHChargeToEdit!==null"
    (ngSubmit)="editOBHChargeFormOps.form.valid">
    <div class="modal fade" id="ops-edit-obh-charge-modal" data-backdrop="static" role="dialog" aria-labelledby=""
        aria-hidden="true">
        <div class="modal-dialog c-modal-fullscreen" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Edit OBH rate</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"
                        (click)="resetChargeForm('ops-edit-obh-charge-modal',editOBHChargeFormOps)">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body" *ngIf="isDisplay">
                    <!--begin::Form-->
                    <div class="m-form m-form--state">
                        <div class="row">
                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': editOBHChargeFormOps.submitted && OBHChargeToEdit.chargeId==null}">
                                    <label class="form-control-label" for="">
                                        Charge <span class="m--font-danger">(*)</span> <small
                                            class="m--margin-left-5 m--font-primary">{{OBHChargeToEdit.chargeCode}}</small>
                                    </label>

                                    <app-combo-grid-virtual-scroll
                                        [currentActiveItemId]="{field:'charge.id',value:OBHChargeToEdit.chargeId}"
                                        [disabled]="OBHChargeToEdit.soano!=null" (itemSelected)="OBHChargeToEdit.chargeId=$event.charge.id;
                                                                OBHChargeToEdit.unitId=$event.charge.unitId;
                                                                OBHChargeToEdit.unitPrice=$event.charge.unitPrice;
                                                                OBHChargeToEdit.vatrate = $event.charge.vatrate;
                                                                OBHChargeToEdit.chargeCode=$event.charge.code;
                                                                OBHChargeToEdit.unit=$event.unit;
                                                                calculateTotalEachOBH(true)"
                                        [selectedDisplayFields]="['charge.chargeNameEn']"
                                        [dataSources]="lstOBHChargesComboBox"
                                        [displayFields]="[{'field':'charge.code','label':'Charge Code'},{'field':'charge.chargeNameEn','label':'Name EN'},{'field':'charge.chargeNameVn','label':'Name VN'}]">
                                    </app-combo-grid-virtual-scroll>

                                    <div class="form-control-feedback"
                                        *ngIf="editOBHChargeFormOps.submitted && OBHChargeToEdit.chargeId==null">
                                        Charge is required
                                    </div>

                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': editOBHChargeFormOps.submitted && OBHChargeToEdit.receiverId==null}">
                                    <label class="form-control-label" for="">
                                        Receiver <span class="m--font-danger">(*)</span>
                                    </label>

                                    <app-combo-grid-virtual-scroll [disabled]="OBHChargeToEdit.soano!=null"
                                        [currentActiveItemId]="{field:'id',value:OBHChargeToEdit.receiverId,hardValue:OBHChargeToEdit.receiverName}"
                                        (itemSelected)="OBHChargeToEdit.receiverId = $event.id;
                                                                    OBHChargeToEdit.receiverName = $event.shortName;"
                                        [selectedDisplayFields]="['shortName']" [dataSources]="lstPartners"
                                        [displayFields]="[{'field':'id','label':'Partner ID'},{'field':'shortName','label':'Name ABBR'},{'field':'partnerNameEn','label':'Name EN'},{'field':'taxCode','label':'Tax Code'}]">
                                    </app-combo-grid-virtual-scroll>

                                    <div class="form-control-feedback"
                                        *ngIf="editOBHChargeFormOps.submitted && OBHChargeToEdit.receiverId==null">
                                        Receiver name is required !
                                    </div>

                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': editOBHChargeFormOps.submitted && OBHChargeToEdit.payerId==null}">
                                    <label class="form-control-label" for="">
                                        Payer <span class="m--font-danger">(*)</span>
                                    </label>

                                    <app-combo-grid-virtual-scroll [disabled]="OBHChargeToEdit.soano!=null"
                                        [currentActiveItemId]="{field:'id',value:OBHChargeToEdit.payerId,hardValue:OBHChargeToEdit.payerName}"
                                        (itemSelected)="OBHChargeToEdit.payerId = $event.id;
                                                                        OBHChargeToEdit.payerName = $event.shortName;"
                                        [selectedDisplayFields]="['shortName']" [dataSources]="lstPartners"
                                        [displayFields]="[{'field':'id','label':'Partner ID'},{'field':'shortName','label':'Name ABBR'},{'field':'partnerNameEn','label':'Name EN'},{'field':'taxCode','label':'Tax Code'}]">
                                    </app-combo-grid-virtual-scroll>

                                    <div class="form-control-feedback"
                                        *ngIf="editOBHChargeFormOps.submitted && OBHChargeToEdit.payerId==null">
                                        Receiver name is required !
                                    </div>

                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': editOBHChargeFormOps.submitted && (OBHQuantityNameEdtOps.invalid || OBHChargeToEdit.quantity == 0) }">
                                    <label class="form-control-label" for="">
                                        Quantity <span class="m--font-danger">(*)</span>
                                    </label>
                                    <input type="number" class="form-control m-input m-input--square"
                                        placeholder="Enter number" #OBHQuantityNameEdtOps="ngModel"
                                        decimalNumberGreaterThan0 [(ngModel)]="OBHChargeToEdit.quantity" required
                                        [disabled]="OBHChargeToEdit.soano!=null" (keyup)="calculateTotalEachOBH(true)"
                                        name="OBHQuantityNameEdtOps">
                                    <div class="form-control-feedback"
                                        *ngIf="editOBHChargeFormOps.submitted && OBHQuantityNameEdtOps.invalid">
                                        Quantity is required !
                                    </div>
                                    <div class="form-control-feedback"
                                        *ngIf="addOBHChargeFormOps.submitted && OBHChargeToEdit.quantity == 0">
                                        Quantity must be greater than 0 !
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': editOBHChargeFormOps.submitted && OBHChargeToEdit.unitId==null}">
                                    <label class="form-control-label" for="">
                                        Unit <span class="m--font-danger">(*)</span>
                                    </label>

                                    <app-combo-grid-virtual-scroll [disabled]="OBHChargeToEdit.soano!=null"
                                        [currentActiveItemId]="{field:'id',value:OBHChargeToEdit.unitId,hardValue:OBHChargeToEdit.unit}"
                                        (itemSelected)="OBHChargeToEdit.unitId = $event.id;
                                                                    OBHChargeToEdit.unit = $event.unitNameEn"
                                        [selectedDisplayFields]="['unitNameEn']" [dataSources]="lstUnits"
                                        [displayFields]="[{'field':'unitNameEn','label':'Name EN'},{'field':'unitType','label':'Unit type'}]">
                                    </app-combo-grid-virtual-scroll>

                                    <div class="form-control-feedback"
                                        *ngIf="editOBHChargeFormOps.submitted && OBHChargeToEdit.chargeId==null">
                                        Unit is required
                                    </div>

                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': editOBHChargeFormOps.submitted &&(OBHUnitPriceNameEdtOps.invalid || (0 >= OBHChargeToEdit.unitPrice)) }">
                                    <label class="form-control-label" for="">
                                        Unit price <span class="m--font-danger">(*)</span>
                                    </label>
                                    <input type="number" class="form-control m-input m-input--square"
                                        [disabled]="OBHChargeToEdit.soano!=null" [(ngModel)]="OBHChargeToEdit.unitPrice"
                                        placeholder="Enter number" required name="OBHUnitPriceNameEdtOps"
                                        #OBHUnitPriceNameEdtOps="ngModel" (keyup)="calculateTotalEachOBH(true)">
                                    <div class="form-control-feedback"
                                        *ngIf="editOBHChargeFormOps.submitted &&(OBHUnitPriceNameEdtOps.invalid || (0 >= OBHChargeToEdit.unitPrice))">
                                        Unit Price is required and must be larger than 0 !
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': editOBHChargeFormOps.submitted && OBHChargeToEdit.currencyId===null }">
                                    <label class="form-control-label" for="">
                                        Currency
                                    </label>
                                    <ng-select [allowClear]="true" [items]="lstCurrencies"
                                        [disabled]="OBHChargeToEdit.soano!=null"
                                        [active]="[{'text':OBHChargeToEdit.currency,'id':OBHChargeToEdit.currencyId}]"
                                        (data)="refreshValue($event)" (selected)="OBHChargeToEdit.currencyId=$event.id"
                                        (removed)="OBHChargeToEdit.currencyId=null" (typed)="getListCurrency($event)"
                                        placeholder="Select filter">
                                    </ng-select>
                                    <div class="form-control-feedback"
                                        *ngIf="editOBHChargeFormOps.submitted && OBHChargeToEdit.currencyId===null ">
                                        Currency is required
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': editOBHChargeFormOps.submitted && (OBHChargeVATNameEdtOps.invalid || OBHChargeToEdit.vatrate > 100)}">
                                    <label class="form-control-label" for="">
                                        VAT
                                    </label>
                                    <input type="number" max="100" name="OBHChargeVATNameEdtOps" required
                                        [disabled]="OBHChargeToEdit.soano!=null" #OBHChargeVATNameEdtOps="ngModel"
                                        [(ngModel)]="OBHChargeToEdit.vatrate"
                                        class="form-control m-input m-input--square" placeholder="Enter number"
                                        (keyup)="calculateTotalEachOBH(true)">
                                    <div class="form-control-feedback"
                                        *ngIf="editOBHChargeFormOps.submitted && (OBHChargeVATNameEdtOps.invalid || OBHChargeToEdit.vatrate > 100)">
                                        VAT is required and must be less than or equal 100
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="form-group">
                                    <label class="form-control-label" for="">
                                        Total
                                    </label>
                                    <input type="text" class="form-control m-input m-input--square" disabled
                                        name="OBHChargeTotalNameEdtOps" [(ngModel)]="OBHChargeToEdit.total">
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-4">
                                <div class="form-group">
                                    <label class="form-control-label" for="">
                                        Doc no
                                    </label>
                                    <input type="text" [(ngModel)]="OBHChargeToEdit.docNo"
                                        [disabled]="OBHChargeToEdit.soano!=null"
                                        class="form-control m-input m-input--square" placeholder="Enter text"
                                        name="OBHChargeDocNameEdtOps">
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="form-group">
                                    <label class="form-control-label" for="">
                                        Note
                                    </label>
                                    <input type="text" [(ngModel)]="OBHChargeToEdit.notes"
                                        [disabled]="OBHChargeToEdit.soano!=null"
                                        class="form-control m-input m-input--square" placeholder="Enter text"
                                        name="OBHChargeNoteNameEdtOps">
                                </div>
                            </div>
                            <!-- <div class="col-lg-4">
                                <div class="form-group">
                                    <label class="form-control-label" for="">
                                        Exchange rate date
                                    </label>
                                    <div class="m-input-icon m-input-icon--right down">
                                        <input type="text" class="form-control m-input m-input--square"
                                            ngxDaterangepickerMd [autoApply]="true" [disabled]=""
                                            [locale]="{applyLabel: 'ok', format: 'DD/MM/YYYY'}"
                                            [(ngModel)]="selectedDate" [singleDatePicker]="true"
                                            name="OBHExchangeDateNameEdt" readonly />
                                        <span class="m-input-icon__icon m-input-icon__icon--right">
                                            <span>
                                                <i class="la la-calendar"></i>
                                            </span>
                                        </span>
                                    </div>
                                </div>
                            </div> -->
                        </div>
                    </div>
                    <!--end::Form-->
                </div>
                <div class="modal-footer m--align-center">
                    <button class="btn btn-brand m-btn--square m-btn--icon m-btn--uppercase" (click)="OBHChargeToEdit.exchangeDate=(OBHChargeToEdit.exchangeDate)==null?null:OBHChargeToEdit.exchangeDate.startDate;
                        editCharge('ops-edit-obh-charge-modal',editOBHChargeFormOps,OBHChargeToEdit)">
                        <span>
                            <i class="la la-save"></i>
                            <span>
                                Save
                            </span>
                        </span>
                    </button>
                    <button type="button" class="btn btn-cancel m-btn--square m-btn--icon m-btn--uppercase"
                        (click)="resetChargeForm('ops-edit-obh-charge-modal',editOBHChargeFormOps)"
                        data-dismiss="modal">
                        <span>
                            <i class="la la-ban"></i>
                            <span>
                                cancel
                            </span>
                        </span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</form>
<!--end:: Edit-obh-charge-modal-->

<!--begin::confirm-delete-charge-modal-->
<div class="modal fade" id="ops-confirm-delete-charge-modal" data-backdrop="static" role="dialog" aria-labelledby=""
    aria-hidden="true">
    <div class="modal-dialog modal-sm" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Cancel</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="confirm-text-block">
                    <span>Are you sure want to delete this Charge?</span>
                </div>
            </div>
            <div class="modal-footer m--align-center c-button-actions">
                <button type="button" class="btn btn-brand m-btn--square m-btn--icon m-btn--uppercase"
                    data-dismiss="modal" (click)="DeleteCharge('ok')">
                    <span>
                        <i class="la la-save"></i>
                        <span>
                            Yes
                        </span>
                    </span>
                </button>
                <button type="reset" class="btn m-btn--square m-btn--icon m-btn--uppercase" data-dismiss="modal">
                    <span>
                        <i class="la la-ban"></i>
                        <span>
                            No
                        </span>
                    </span>
                </button>
            </div>
        </div>
    </div>
</div>
<!--end::confirm-delete-charge-modal-->

<!--begin::cancel-create-ops-job-modal-->
<div class="modal fade" id="cancel-create-ops-job-modal" data-backdrop="static" role="dialog" aria-labelledby=""
    aria-hidden="true">
    <div class="modal-dialog modal-sm" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Cancel</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="confirm-text-block">
                    <span>All entered data will be discarded, <br>Are you sure you want to leave? </span>
                </div>
            </div>
            <div class="modal-footer m--align-center c-button-actions">
                <button type="button" class="btn btn-brand m-btn--square m-btn--icon m-btn--uppercase"
                    data-dismiss="modal" routerLink="/home/operation/job-management">
                    <span>
                        <i class="la la-save"></i>
                        <span>
                            Yes
                        </span>
                    </span>
                </button>
                <button type="button" class="btn btn-cancel m-btn--square m-btn--icon m-btn--uppercase"
                    data-dismiss="modal">
                    <span>
                        <i class="la la-ban"></i>
                        <span>
                            No
                        </span>
                    </span>
                </button>
            </div>
        </div>
    </div>
</div>
<!--end::cancel-create-ops-job-modal-->


<!--begin::confirm-can-not-delete-job-modal-->
<div class="modal fade" id="confirm-can-not-delete-job-modal" data-backdrop="static" role="dialog" aria-labelledby=""
    aria-hidden="true">
    <div class="modal-dialog modal-sm" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Notification</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="confirm-text-block">
                    <span>You are not allow to delete this job</span>
                </div>
            </div>
            <div class="modal-footer m--align-center c-button-actions">
                <button type="button" class="btn btn-brand m-btn--square m-btn--icon m-btn--uppercase"
                    data-dismiss="modal">
                    <span>
                        <i class="la la-save"></i>
                        <span>
                            OK
                        </span>
                    </span>
                </button>
            </div>
        </div>
    </div>
</div>
<!--end::confirm-can-not-delete-job-modal-->

<!--begin::confirm-delete-job-modal-->
<div class="modal fade" id="confirm-delete-job-modal" data-backdrop="static" role="dialog" aria-labelledby=""
    aria-hidden="true">
    <div class="modal-dialog modal-sm" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Notification</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="confirm-text-block">
                    <span>Do you want to delete <span class="m--font-bold">job Name</span>item?</span>
                </div>
            </div>
            <div class="modal-footer m--align-center c-button-actions">
                <button type="button" class="btn btn-brand m-btn--square m-btn--icon m-btn--uppercase"
                    (click)="deleteJob()">
                    <span>
                        <i class="la la-save"></i>
                        <span>
                            Ok
                        </span>
                    </span>
                </button>
                <button type="button" class="btn btn-cancel m-btn--square m-btn--icon m-btn--uppercase"
                    data-dismiss="modal">
                    <span>
                        <i class="la la-ban"></i>
                        <span>
                            cancel
                        </span>
                    </span>
                </button>
            </div>
        </div>
    </div>
</div>
<!--end::confirm-delete-job-modal-->

<!--begin::confirm-cancel-job-modal-->
<div class="modal fade" id="confirm-cancel-job-modal" data-backdrop="static" role="dialog" aria-labelledby=""
    aria-hidden="true">
    <div class="modal-dialog modal-sm" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Notification</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="confirm-text-block">
                    <span>Unsaved data will be lost. Are you sure want to leave?</span>
                </div>
            </div>
            <div class="modal-footer m--align-center c-button-actions">
                <button type="button" class="btn btn-brand m-btn--square m-btn--icon m-btn--uppercase"
                    [routerLink]="['/home/operation/job-management']" data-dismiss="modal">
                    <span>
                        <i class="la la-save"></i>
                        <span>
                            Yes
                        </span>
                    </span>
                </button>
                <button type="button" class="btn btn-cancel m-btn--square m-btn--icon m-btn--uppercase"
                    data-dismiss="modal">
                    <span>
                        <i class="la la-ban"></i>
                        <span>
                            No
                        </span>
                    </span>
                </button>
            </div>
        </div>
    </div>
</div>
<!--end::confirm-cancel-job-modal-->