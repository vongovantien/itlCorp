<div class="form-combine-receipt">
    <div class="d-flex align-items-center justify-content-between p-1">
        <h3>
            <span><i class="la la-edit"></i></span>
            {{!isUpdate ? 'Create' : 'Update'}} Combine Receipt
            <ng-container *ngIf="isUpdate && typeCombine !== 'existing'">
                <ng-container *ngIf="isBalance; else notComplete">
                    <span class="btn btn-success btn-sm m-btn--pill m-btn--icon m-btn--icon-only m--margin-left-10">
                        <i class="la la-check"></i>
                    </span>
                </ng-container>
                <ng-template #notComplete>
                    <span class="btn btn-danger btn-sm m-btn--pill m-btn--icon m-btn--icon-only m--margin-left-10">
                        <i class="la la-exclamation"></i>
                    </span>
                </ng-template>
            </ng-container>
        </h3>
        <div class="c-button-actions">
            <ng-container *ngIf="isAllDone">
                <app-permission-button title="Sync to Accountant" type="sync" class="info" icon="la la-cloud-upload"
                    (onClick)="confirmSync()">
                </app-permission-button>
            </ng-container>
            <app-default-button [buttonSetting]="cancelButtonSetting" (onClick)="confirmCancel()">
            </app-default-button>
        </div>
    </div>
    <form [formGroup]="form" class="row m-form m-form--state">
        <div class="col-lg-6">
            <div class="form-group"
                [ngClass]="{'m-form__group has-danger':isSubmitted && (!partnerId?.value && !partnerId.valid) }">
                <label class="form-control-label" required>
                    Agency:
                </label>
                <app-combo-grid-virtual-scroll #comboGridPartner
                    (itemSelected)="onSelectDataFormInfo($event, 'partner')" (remove)="resetFormControl(partnerId)"
                    [currentActiveItemId]="{ field: 'contractId', value: partnerId.value, hardValue: partnerName }"
                    [selectedDisplayFields]="['shortName','salemanName']" [dataSources]="partners | async"
                    [displayFields]="displayFieldsPartner" placeholder="Select Partner" [clearable]="false"
                    [disabled]="isUpdate">
                </app-combo-grid-virtual-scroll>
            </div>
        </div>
        <div class="col-lg-6">
            <div class="form-group">
                <label class="form-control-label" required>
                    AR Combine No:
                </label>
                <input type="text" class="form-control m-input m-input--square text-primary"
                    formControlName="combineNo" [attr.disabled]="true">
            </div>
        </div>
        <div class="col-lg-6">
            <div class="form-group">
                <label class="form-control-label">
                    Payment Date:
                </label>
                <div class="m-input-icon m-input-icon--right down daterange-rtl">
                    <input type="text" ngxDaterangepickerMd class="form-control"
                        [locale]="{applyLabel: 'apply', format: 'DD/MM/YYYY'}" name="daterange" placeholder="DD/MM/YYYY"
                        [autoApply]="true" formControlName="paymentDate" [singleDatePicker]="true" readonly calendar
                        [attr.disabled]="isUpdate" [allowRemove]="false" (datesUpdated)="onChangePaymentDate($event)"/>
                </div>
            </div>
        </div>
        <div class="col-lg-6">
            <div class="row">
                <div class="col-lg-6">
                    <div class="form-group"
                        [ngClass]="{'m-form__group has-danger':((!exchangeRate?.value && !exchangeRate.valid) || exchangeRate.value <= 0) }">
                        <label class="form-control-label">
                            Exchange Rate:
                        </label>
                        <input type="number" class="form-control m-input m-input--square font-15"
                            formControlName="exchangeRate" [attr.disabled]="isUpdate === true ? 'disabled' : null" numeric [decimals]="0"
                            autoFormatCurrency (change)="onSelectDataFormInfo($event,'exchangeRate')">
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="form-group">
                        <label class="form-control-label">
                            Currency:
                        </label>
                        <input type="text" formControlName="currency" class="form-control text-primary">
                    </div>
                </div>
            </div>

        </div>
    </form>
</div>

<ng-template inject></ng-template>